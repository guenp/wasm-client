/**
 * Skipped minification because the original files appears to be already minified.
 * Original file: /npm/@motherduck/wasm-client@0.6.6/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var Fu=Object.create;var Ys=Object.defineProperty;var Mu=Object.getOwnPropertyDescriptor;var Uu=Object.getOwnPropertyNames;var Bu=Object.getPrototypeOf,qu=Object.prototype.hasOwnProperty;var i=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var xu=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Uu(r))!qu.call(e,n)&&n!==t&&Ys(e,n,{get:()=>r[n],enumerable:!(s=Mu(r,n))||s.enumerable});return e};var ju=(e,r,t)=>(t=e!=null?Fu(Bu(e)):{},xu(r||!e||!e.__esModule?Ys(t,"default",{value:e,enumerable:!0}):t,e));var I=i((ut,kn)=>{"use strict";var Qe=function(e){return e&&e.Math===Math&&e};kn.exports=Qe(typeof globalThis=="object"&&globalThis)||Qe(typeof window=="object"&&window)||Qe(typeof self=="object"&&self)||Qe(typeof global=="object"&&global)||Qe(typeof ut=="object"&&ut)||function(){return this}()||Function("return this")()});var A=i((q_,On)=>{"use strict";On.exports=function(e){try{return!!e()}catch{return!0}}});var B=i((x_,An)=>{"use strict";var nl=A();An.exports=!nl(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var We=i((j_,Pn)=>{"use strict";var al=A();Pn.exports=!al(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")})});var P=i((G_,Cn)=>{"use strict";var il=We(),pr=Function.prototype.call;Cn.exports=il?pr.bind(pr):function(){return pr.apply(pr,arguments)}});var Un=i(Mn=>{"use strict";var Ln={}.propertyIsEnumerable,Fn=Object.getOwnPropertyDescriptor,ol=Fn&&!Ln.call({1:2},1);Mn.f=ol?function(r){var t=Fn(this,r);return!!t&&t.enumerable}:Ln});var dt=i((W_,Bn)=>{"use strict";Bn.exports=function(e,r){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:r}}});var w=i((Y_,jn)=>{"use strict";var qn=We(),xn=Function.prototype,lt=xn.call,cl=qn&&xn.bind.bind(lt,lt);jn.exports=qn?cl:function(e){return function(){return lt.apply(e,arguments)}}});var Ye=i((H_,Qn)=>{"use strict";var Gn=w(),ul=Gn({}.toString),dl=Gn("".slice);Qn.exports=function(e){return dl(ul(e),8,-1)}});var Yn=i(($_,Wn)=>{"use strict";var ll=w(),pl=A(),El=Ye(),pt=Object,ml=ll("".split);Wn.exports=pl(function(){return!pt("z").propertyIsEnumerable(0)})?function(e){return El(e)==="String"?ml(e,""):pt(e)}:pt});var He=i((V_,Hn)=>{"use strict";Hn.exports=function(e){return e==null}});var Er=i((K_,$n)=>{"use strict";var hl=He(),Tl=TypeError;$n.exports=function(e){if(hl(e))throw new Tl("Can't call method on "+e);return e}});var mr=i((z_,Vn)=>{"use strict";var fl=Yn(),Rl=Er();Vn.exports=function(e){return fl(Rl(e))}});var _=i((J_,Kn)=>{"use strict";var Et=typeof document=="object"&&document.all;Kn.exports=typeof Et>"u"&&Et!==void 0?function(e){return typeof e=="function"||e===Et}:function(e){return typeof e=="function"}});var q=i((Z_,zn)=>{"use strict";var gl=_();zn.exports=function(e){return typeof e=="object"?e!==null:gl(e)}});var $=i((X_,Jn)=>{"use strict";var mt=I(),Il=_(),_l=function(e){return Il(e)?e:void 0};Jn.exports=function(e,r){return arguments.length<2?_l(mt[e]):mt[e]&&mt[e][r]}});var hr=i((ey,Zn)=>{"use strict";var yl=w();Zn.exports=yl({}.isPrototypeOf)});var ue=i((ry,ra)=>{"use strict";var Sl=I(),Xn=Sl.navigator,ea=Xn&&Xn.userAgent;ra.exports=ea?String(ea):""});var Tt=i((ty,oa)=>{"use strict";var ia=I(),ht=ue(),ta=ia.process,sa=ia.Deno,na=ta&&ta.versions||sa&&sa.version,aa=na&&na.v8,C,Tr;aa&&(C=aa.split("."),Tr=C[0]>0&&C[0]<4?1:+(C[0]+C[1]));!Tr&&ht&&(C=ht.match(/Edge\/(\d+)/),(!C||C[1]>=74)&&(C=ht.match(/Chrome\/(\d+)/),C&&(Tr=+C[1])));oa.exports=Tr});var ft=i((sy,ua)=>{"use strict";var ca=Tt(),vl=A(),bl=I(),wl=bl.String;ua.exports=!!Object.getOwnPropertySymbols&&!vl(function(){var e=Symbol("symbol detection");return!wl(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ca&&ca<41})});var Rt=i((ny,da)=>{"use strict";var Dl=ft();da.exports=Dl&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var gt=i((ay,la)=>{"use strict";var Nl=$(),kl=_(),Ol=hr(),Al=Rt(),Pl=Object;la.exports=Al?function(e){return typeof e=="symbol"}:function(e){var r=Nl("Symbol");return kl(r)&&Ol(r.prototype,Pl(e))}});var $e=i((iy,pa)=>{"use strict";var Cl=String;pa.exports=function(e){try{return Cl(e)}catch{return"Object"}}});var Y=i((oy,Ea)=>{"use strict";var Ll=_(),Fl=$e(),Ml=TypeError;Ea.exports=function(e){if(Ll(e))return e;throw new Ml(Fl(e)+" is not a function")}});var fr=i((cy,ma)=>{"use strict";var Ul=Y(),Bl=He();ma.exports=function(e,r){var t=e[r];return Bl(t)?void 0:Ul(t)}});var Ta=i((uy,ha)=>{"use strict";var It=P(),_t=_(),yt=q(),ql=TypeError;ha.exports=function(e,r){var t,s;if(r==="string"&&_t(t=e.toString)&&!yt(s=It(t,e))||_t(t=e.valueOf)&&!yt(s=It(t,e))||r!=="string"&&_t(t=e.toString)&&!yt(s=It(t,e)))return s;throw new ql("Can't convert object to primitive value")}});var de=i((dy,fa)=>{"use strict";fa.exports=!1});var Rr=i((ly,ga)=>{"use strict";var Ra=I(),xl=Object.defineProperty;ga.exports=function(e,r){try{xl(Ra,e,{value:r,configurable:!0,writable:!0})}catch{Ra[e]=r}return r}});var gr=i((py,ya)=>{"use strict";var jl=de(),Gl=I(),Ql=Rr(),Ia="__core-js_shared__",_a=ya.exports=Gl[Ia]||Ql(Ia,{});(_a.versions||(_a.versions=[])).push({version:"3.38.1",mode:jl?"pure":"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"})});var St=i((Ey,va)=>{"use strict";var Sa=gr();va.exports=function(e,r){return Sa[e]||(Sa[e]=r||{})}});var wa=i((my,ba)=>{"use strict";var Wl=Er(),Yl=Object;ba.exports=function(e){return Yl(Wl(e))}});var x=i((hy,Da)=>{"use strict";var Hl=w(),$l=wa(),Vl=Hl({}.hasOwnProperty);Da.exports=Object.hasOwn||function(r,t){return Vl($l(r),t)}});var vt=i((Ty,Na)=>{"use strict";var Kl=w(),zl=0,Jl=Math.random(),Zl=Kl(1 .toString);Na.exports=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Zl(++zl+Jl,36)}});var L=i((fy,Oa)=>{"use strict";var Xl=I(),ep=St(),ka=x(),rp=vt(),tp=ft(),sp=Rt(),le=Xl.Symbol,bt=ep("wks"),np=sp?le.for||le:le&&le.withoutSetter||rp;Oa.exports=function(e){return ka(bt,e)||(bt[e]=tp&&ka(le,e)?le[e]:np("Symbol."+e)),bt[e]}});var La=i((Ry,Ca)=>{"use strict";var ap=P(),Aa=q(),Pa=gt(),ip=fr(),op=Ta(),cp=L(),up=TypeError,dp=cp("toPrimitive");Ca.exports=function(e,r){if(!Aa(e)||Pa(e))return e;var t=ip(e,dp),s;if(t){if(r===void 0&&(r="default"),s=ap(t,e,r),!Aa(s)||Pa(s))return s;throw new up("Can't convert object to primitive value")}return r===void 0&&(r="number"),op(e,r)}});var wt=i((gy,Fa)=>{"use strict";var lp=La(),pp=gt();Fa.exports=function(e){var r=lp(e,"string");return pp(r)?r:r+""}});var Nt=i((Iy,Ua)=>{"use strict";var Ep=I(),Ma=q(),Dt=Ep.document,mp=Ma(Dt)&&Ma(Dt.createElement);Ua.exports=function(e){return mp?Dt.createElement(e):{}}});var kt=i((_y,Ba)=>{"use strict";var hp=B(),Tp=A(),fp=Nt();Ba.exports=!hp&&!Tp(function(){return Object.defineProperty(fp("div"),"a",{get:function(){return 7}}).a!==7})});var Ot=i(xa=>{"use strict";var Rp=B(),gp=P(),Ip=Un(),_p=dt(),yp=mr(),Sp=wt(),vp=x(),bp=kt(),qa=Object.getOwnPropertyDescriptor;xa.f=Rp?qa:function(r,t){if(r=yp(r),t=Sp(t),bp)try{return qa(r,t)}catch{}if(vp(r,t))return _p(!gp(Ip.f,r,t),r[t])}});var Ga=i((Sy,ja)=>{"use strict";var wp=B(),Dp=A();ja.exports=wp&&Dp(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var V=i((vy,Qa)=>{"use strict";var Np=q(),kp=String,Op=TypeError;Qa.exports=function(e){if(Np(e))return e;throw new Op(kp(e)+" is not an object")}});var pe=i(Ya=>{"use strict";var Ap=B(),Pp=kt(),Cp=Ga(),Ir=V(),Wa=wt(),Lp=TypeError,At=Object.defineProperty,Fp=Object.getOwnPropertyDescriptor,Pt="enumerable",Ct="configurable",Lt="writable";Ya.f=Ap?Cp?function(r,t,s){if(Ir(r),t=Wa(t),Ir(s),typeof r=="function"&&t==="prototype"&&"value"in s&&Lt in s&&!s[Lt]){var n=Fp(r,t);n&&n[Lt]&&(r[t]=s.value,s={configurable:Ct in s?s[Ct]:n[Ct],enumerable:Pt in s?s[Pt]:n[Pt],writable:!1})}return At(r,t,s)}:At:function(r,t,s){if(Ir(r),t=Wa(t),Ir(s),Pp)try{return At(r,t,s)}catch{}if("get"in s||"set"in s)throw new Lp("Accessors not supported");return"value"in s&&(r[t]=s.value),r}});var Ft=i((wy,Ha)=>{"use strict";var Mp=B(),Up=pe(),Bp=dt();Ha.exports=Mp?function(e,r,t){return Up.f(e,r,Bp(1,t))}:function(e,r,t){return e[r]=t,e}});var Ka=i((Dy,Va)=>{"use strict";var Mt=B(),qp=x(),$a=Function.prototype,xp=Mt&&Object.getOwnPropertyDescriptor,Ut=qp($a,"name"),jp=Ut&&function(){}.name==="something",Gp=Ut&&(!Mt||Mt&&xp($a,"name").configurable);Va.exports={EXISTS:Ut,PROPER:jp,CONFIGURABLE:Gp}});var _r=i((Ny,za)=>{"use strict";var Qp=w(),Wp=_(),Bt=gr(),Yp=Qp(Function.toString);Wp(Bt.inspectSource)||(Bt.inspectSource=function(e){return Yp(e)});za.exports=Bt.inspectSource});var Xa=i((ky,Za)=>{"use strict";var Hp=I(),$p=_(),Ja=Hp.WeakMap;Za.exports=$p(Ja)&&/native code/.test(String(Ja))});var ti=i((Oy,ri)=>{"use strict";var Vp=St(),Kp=vt(),ei=Vp("keys");ri.exports=function(e){return ei[e]||(ei[e]=Kp(e))}});var qt=i((Ay,si)=>{"use strict";si.exports={}});var Qt=i((Py,ii)=>{"use strict";var zp=Xa(),ai=I(),Jp=q(),Zp=Ft(),xt=x(),jt=gr(),Xp=ti(),eE=qt(),ni="Object already initialized",Gt=ai.TypeError,rE=ai.WeakMap,yr,Ve,Sr,tE=function(e){return Sr(e)?Ve(e):yr(e,{})},sE=function(e){return function(r){var t;if(!Jp(r)||(t=Ve(r)).type!==e)throw new Gt("Incompatible receiver, "+e+" required");return t}};zp||jt.state?(F=jt.state||(jt.state=new rE),F.get=F.get,F.has=F.has,F.set=F.set,yr=function(e,r){if(F.has(e))throw new Gt(ni);return r.facade=e,F.set(e,r),r},Ve=function(e){return F.get(e)||{}},Sr=function(e){return F.has(e)}):(te=Xp("state"),eE[te]=!0,yr=function(e,r){if(xt(e,te))throw new Gt(ni);return r.facade=e,Zp(e,te,r),r},Ve=function(e){return xt(e,te)?e[te]:{}},Sr=function(e){return xt(e,te)});var F,te;ii.exports={set:yr,get:Ve,has:Sr,enforce:tE,getterFor:sE}});var Ht=i((Cy,ui)=>{"use strict";var Yt=w(),nE=A(),aE=_(),vr=x(),Wt=B(),iE=Ka().CONFIGURABLE,oE=_r(),ci=Qt(),cE=ci.enforce,uE=ci.get,oi=String,br=Object.defineProperty,dE=Yt("".slice),lE=Yt("".replace),pE=Yt([].join),EE=Wt&&!nE(function(){return br(function(){},"length",{value:8}).length!==8}),mE=String(String).split("String"),hE=ui.exports=function(e,r,t){dE(oi(r),0,7)==="Symbol("&&(r="["+lE(oi(r),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(r="get "+r),t&&t.setter&&(r="set "+r),(!vr(e,"name")||iE&&e.name!==r)&&(Wt?br(e,"name",{value:r,configurable:!0}):e.name=r),EE&&t&&vr(t,"arity")&&e.length!==t.arity&&br(e,"length",{value:t.arity});try{t&&vr(t,"constructor")&&t.constructor?Wt&&br(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var s=cE(e);return vr(s,"source")||(s.source=pE(mE,typeof r=="string"?r:"")),e};Function.prototype.toString=hE(function(){return aE(this)&&uE(this).source||oE(this)},"toString")});var wr=i((Ly,di)=>{"use strict";var TE=_(),fE=pe(),RE=Ht(),gE=Rr();di.exports=function(e,r,t,s){s||(s={});var n=s.enumerable,a=s.name!==void 0?s.name:r;if(TE(t)&&RE(t,a,s),s.global)n?e[r]=t:gE(r,t);else{try{s.unsafe?e[r]&&(n=!0):delete e[r]}catch{}n?e[r]=t:fE.f(e,r,{value:t,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}});var pi=i((Fy,li)=>{"use strict";var IE=Math.ceil,_E=Math.floor;li.exports=Math.trunc||function(r){var t=+r;return(t>0?_E:IE)(t)}});var $t=i((My,Ei)=>{"use strict";var yE=pi();Ei.exports=function(e){var r=+e;return r!==r||r===0?0:yE(r)}});var hi=i((Uy,mi)=>{"use strict";var SE=$t(),vE=Math.max,bE=Math.min;mi.exports=function(e,r){var t=SE(e);return t<0?vE(t+r,0):bE(t,r)}});var fi=i((By,Ti)=>{"use strict";var wE=$t(),DE=Math.min;Ti.exports=function(e){var r=wE(e);return r>0?DE(r,9007199254740991):0}});var Vt=i((qy,Ri)=>{"use strict";var NE=fi();Ri.exports=function(e){return NE(e.length)}});var _i=i((xy,Ii)=>{"use strict";var kE=mr(),OE=hi(),AE=Vt(),gi=function(e){return function(r,t,s){var n=kE(r),a=AE(n);if(a===0)return!e&&-1;var o=OE(s,a),u;if(e&&t!==t){for(;a>o;)if(u=n[o++],u!==u)return!0}else for(;a>o;o++)if((e||o in n)&&n[o]===t)return e||o||0;return!e&&-1}};Ii.exports={includes:gi(!0),indexOf:gi(!1)}});var vi=i((jy,Si)=>{"use strict";var PE=w(),Kt=x(),CE=mr(),LE=_i().indexOf,FE=qt(),yi=PE([].push);Si.exports=function(e,r){var t=CE(e),s=0,n=[],a;for(a in t)!Kt(FE,a)&&Kt(t,a)&&yi(n,a);for(;r.length>s;)Kt(t,a=r[s++])&&(~LE(n,a)||yi(n,a));return n}});var wi=i((Gy,bi)=>{"use strict";bi.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var Ni=i(Di=>{"use strict";var ME=vi(),UE=wi(),BE=UE.concat("length","prototype");Di.f=Object.getOwnPropertyNames||function(r){return ME(r,BE)}});var Oi=i(ki=>{"use strict";ki.f=Object.getOwnPropertySymbols});var Pi=i((Yy,Ai)=>{"use strict";var qE=$(),xE=w(),jE=Ni(),GE=Oi(),QE=V(),WE=xE([].concat);Ai.exports=qE("Reflect","ownKeys")||function(r){var t=jE.f(QE(r)),s=GE.f;return s?WE(t,s(r)):t}});var Fi=i((Hy,Li)=>{"use strict";var Ci=x(),YE=Pi(),HE=Ot(),$E=pe();Li.exports=function(e,r,t){for(var s=YE(r),n=$E.f,a=HE.f,o=0;o<s.length;o++){var u=s[o];!Ci(e,u)&&!(t&&Ci(t,u))&&n(e,u,a(r,u))}}});var zt=i(($y,Mi)=>{"use strict";var VE=A(),KE=_(),zE=/#|\.prototype\./,Ke=function(e,r){var t=ZE[JE(e)];return t===em?!0:t===XE?!1:KE(r)?VE(r):!!r},JE=Ke.normalize=function(e){return String(e).replace(zE,".").toLowerCase()},ZE=Ke.data={},XE=Ke.NATIVE="N",em=Ke.POLYFILL="P";Mi.exports=Ke});var K=i((Vy,Ui)=>{"use strict";var Dr=I(),rm=Ot().f,tm=Ft(),sm=wr(),nm=Rr(),am=Fi(),im=zt();Ui.exports=function(e,r){var t=e.target,s=e.global,n=e.stat,a,o,u,d,E,g;if(s?o=Dr:n?o=Dr[t]||nm(t,{}):o=Dr[t]&&Dr[t].prototype,o)for(u in r){if(E=r[u],e.dontCallGetSet?(g=rm(o,u),d=g&&g.value):d=o[u],a=im(s?u:t+(n?".":"#")+u,e.forced),!a&&d!==void 0){if(typeof E==typeof d)continue;am(E,d)}(e.sham||d&&d.sham)&&tm(E,"sham",!0),sm(o,u,E,e)}}});var Jt=i((Ky,Bi)=>{"use strict";var ze=I(),om=ue(),cm=Ye(),Nr=function(e){return om.slice(0,e.length)===e};Bi.exports=function(){return Nr("Bun/")?"BUN":Nr("Cloudflare-Workers")?"CLOUDFLARE":Nr("Deno/")?"DENO":Nr("Node.js/")?"NODE":ze.Bun&&typeof Bun.version=="string"?"BUN":ze.Deno&&typeof Deno.version=="object"?"DENO":cm(ze.process)==="process"?"NODE":ze.window&&ze.document?"BROWSER":"REST"}()});var kr=i((zy,qi)=>{"use strict";var um=Jt();qi.exports=um==="NODE"});var ji=i((Jy,xi)=>{"use strict";var dm=w(),lm=Y();xi.exports=function(e,r,t){try{return dm(lm(Object.getOwnPropertyDescriptor(e,r)[t]))}catch{}}});var Qi=i((Zy,Gi)=>{"use strict";var pm=q();Gi.exports=function(e){return pm(e)||e===null}});var Yi=i((Xy,Wi)=>{"use strict";var Em=Qi(),mm=String,hm=TypeError;Wi.exports=function(e){if(Em(e))return e;throw new hm("Can't set "+mm(e)+" as a prototype")}});var $i=i((eS,Hi)=>{"use strict";var Tm=ji(),fm=q(),Rm=Er(),gm=Yi();Hi.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,r={},t;try{t=Tm(Object.prototype,"__proto__","set"),t(r,[]),e=r instanceof Array}catch{}return function(n,a){return Rm(n),gm(a),fm(n)&&(e?t(n,a):n.__proto__=a),n}}():void 0)});var zi=i((rS,Ki)=>{"use strict";var Im=pe().f,_m=x(),ym=L(),Vi=ym("toStringTag");Ki.exports=function(e,r,t){e&&!t&&(e=e.prototype),e&&!_m(e,Vi)&&Im(e,Vi,{configurable:!0,value:r})}});var Xi=i((tS,Zi)=>{"use strict";var Ji=Ht(),Sm=pe();Zi.exports=function(e,r,t){return t.get&&Ji(t.get,r,{getter:!0}),t.set&&Ji(t.set,r,{setter:!0}),Sm.f(e,r,t)}});var to=i((sS,ro)=>{"use strict";var vm=$(),bm=Xi(),wm=L(),Dm=B(),eo=wm("species");ro.exports=function(e){var r=vm(e);Dm&&r&&!r[eo]&&bm(r,eo,{configurable:!0,get:function(){return this}})}});var no=i((nS,so)=>{"use strict";var Nm=hr(),km=TypeError;so.exports=function(e,r){if(Nm(r,e))return e;throw new km("Incorrect invocation")}});var oo=i((aS,io)=>{"use strict";var Om=L(),Am=Om("toStringTag"),ao={};ao[Am]="z";io.exports=String(ao)==="[object z]"});var Zt=i((iS,co)=>{"use strict";var Pm=oo(),Cm=_(),Or=Ye(),Lm=L(),Fm=Lm("toStringTag"),Mm=Object,Um=Or(function(){return arguments}())==="Arguments",Bm=function(e,r){try{return e[r]}catch{}};co.exports=Pm?Or:function(e){var r,t,s;return e===void 0?"Undefined":e===null?"Null":typeof(t=Bm(r=Mm(e),Fm))=="string"?t:Um?Or(r):(s=Or(r))==="Object"&&Cm(r.callee)?"Arguments":s}});var ho=i((oS,mo)=>{"use strict";var qm=w(),xm=A(),uo=_(),jm=Zt(),Gm=$(),Qm=_r(),lo=function(){},po=Gm("Reflect","construct"),Xt=/^\s*(?:class|function)\b/,Wm=qm(Xt.exec),Ym=!Xt.test(lo),Je=function(r){if(!uo(r))return!1;try{return po(lo,[],r),!0}catch{return!1}},Eo=function(r){if(!uo(r))return!1;switch(jm(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ym||!!Wm(Xt,Qm(r))}catch{return!0}};Eo.sham=!0;mo.exports=!po||xm(function(){var e;return Je(Je.call)||!Je(Object)||!Je(function(){e=!0})||e})?Eo:Je});var fo=i((cS,To)=>{"use strict";var Hm=ho(),$m=$e(),Vm=TypeError;To.exports=function(e){if(Hm(e))return e;throw new Vm($m(e)+" is not a constructor")}});var Io=i((uS,go)=>{"use strict";var Ro=V(),Km=fo(),zm=He(),Jm=L(),Zm=Jm("species");go.exports=function(e,r){var t=Ro(e).constructor,s;return t===void 0||zm(s=Ro(t)[Zm])?r:Km(s)}});var bo=i((dS,vo)=>{"use strict";var Xm=We(),So=Function.prototype,_o=So.apply,yo=So.call;vo.exports=typeof Reflect=="object"&&Reflect.apply||(Xm?yo.bind(_o):function(){return yo.apply(_o,arguments)})});var Do=i((lS,wo)=>{"use strict";var eh=Ye(),rh=w();wo.exports=function(e){if(eh(e)==="Function")return rh(e)}});var Ar=i((pS,ko)=>{"use strict";var No=Do(),th=Y(),sh=We(),nh=No(No.bind);ko.exports=function(e,r){return th(e),r===void 0?e:sh?nh(e,r):function(){return e.apply(r,arguments)}}});var Ao=i((ES,Oo)=>{"use strict";var ah=$();Oo.exports=ah("document","documentElement")});var Co=i((mS,Po)=>{"use strict";var ih=w();Po.exports=ih([].slice)});var Fo=i((hS,Lo)=>{"use strict";var oh=TypeError;Lo.exports=function(e,r){if(e<r)throw new oh("Not enough arguments");return e}});var es=i((TS,Mo)=>{"use strict";var ch=ue();Mo.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(ch)});var us=i((fS,Yo)=>{"use strict";var D=I(),uh=bo(),dh=Ar(),Uo=_(),lh=x(),Wo=A(),Bo=Ao(),ph=Co(),qo=Nt(),Eh=Fo(),mh=es(),hh=kr(),is=D.setImmediate,os=D.clearImmediate,Th=D.process,rs=D.Dispatch,fh=D.Function,xo=D.MessageChannel,Rh=D.String,ts=0,Ze={},jo="onreadystatechange",Xe,se,ss,ns;Wo(function(){Xe=D.location});var cs=function(e){if(lh(Ze,e)){var r=Ze[e];delete Ze[e],r()}},as=function(e){return function(){cs(e)}},Go=function(e){cs(e.data)},Qo=function(e){D.postMessage(Rh(e),Xe.protocol+"//"+Xe.host)};(!is||!os)&&(is=function(r){Eh(arguments.length,1);var t=Uo(r)?r:fh(r),s=ph(arguments,1);return Ze[++ts]=function(){uh(t,void 0,s)},se(ts),ts},os=function(r){delete Ze[r]},hh?se=function(e){Th.nextTick(as(e))}:rs&&rs.now?se=function(e){rs.now(as(e))}:xo&&!mh?(ss=new xo,ns=ss.port2,ss.port1.onmessage=Go,se=dh(ns.postMessage,ns)):D.addEventListener&&Uo(D.postMessage)&&!D.importScripts&&Xe&&Xe.protocol!=="file:"&&!Wo(Qo)?(se=Qo,D.addEventListener("message",Go,!1)):jo in qo("script")?se=function(e){Bo.appendChild(qo("script"))[jo]=function(){Bo.removeChild(this),cs(e)}}:se=function(e){setTimeout(as(e),0)});Yo.exports={set:is,clear:os}});var Vo=i((RS,$o)=>{"use strict";var Ho=I(),gh=B(),Ih=Object.getOwnPropertyDescriptor;$o.exports=function(e){if(!gh)return Ho[e];var r=Ih(Ho,e);return r&&r.value}});var ds=i((gS,zo)=>{"use strict";var Ko=function(){this.head=null,this.tail=null};Ko.prototype={add:function(e){var r={item:e,next:null},t=this.tail;t?t.next=r:this.head=r,this.tail=r},get:function(){var e=this.head;if(e){var r=this.head=e.next;return r===null&&(this.tail=null),e.item}}};zo.exports=Ko});var Zo=i((IS,Jo)=>{"use strict";var _h=ue();Jo.exports=/ipad|iphone|ipod/i.test(_h)&&typeof Pebble<"u"});var ec=i((_S,Xo)=>{"use strict";var yh=ue();Xo.exports=/web0s(?!.*chrome)/i.test(yh)});var oc=i((yS,ic)=>{"use strict";var me=I(),Sh=Vo(),rc=Ar(),ls=us().set,vh=ds(),bh=es(),wh=Zo(),Dh=ec(),ps=kr(),tc=me.MutationObserver||me.WebKitMutationObserver,sc=me.document,nc=me.process,Pr=me.Promise,hs=Sh("queueMicrotask"),Ee,Es,ms,Cr,ac;hs||(er=new vh,rr=function(){var e,r;for(ps&&(e=nc.domain)&&e.exit();r=er.get();)try{r()}catch(t){throw er.head&&Ee(),t}e&&e.enter()},!bh&&!ps&&!Dh&&tc&&sc?(Es=!0,ms=sc.createTextNode(""),new tc(rr).observe(ms,{characterData:!0}),Ee=function(){ms.data=Es=!Es}):!wh&&Pr&&Pr.resolve?(Cr=Pr.resolve(void 0),Cr.constructor=Pr,ac=rc(Cr.then,Cr),Ee=function(){ac(rr)}):ps?Ee=function(){nc.nextTick(rr)}:(ls=rc(ls,me),Ee=function(){ls(rr)}),hs=function(e){er.head||Ee(),er.add(e)});var er,rr;ic.exports=hs});var uc=i((SS,cc)=>{"use strict";cc.exports=function(e,r){try{arguments.length===1?console.error(e):console.error(e,r)}catch{}}});var Lr=i((vS,dc)=>{"use strict";dc.exports=function(e){try{return{error:!1,value:e()}}catch(r){return{error:!0,value:r}}}});var he=i((bS,lc)=>{"use strict";var Nh=I();lc.exports=Nh.Promise});var Te=i((wS,hc)=>{"use strict";var kh=I(),tr=he(),Oh=_(),Ah=zt(),Ph=_r(),Ch=L(),pc=Jt(),Lh=de(),Ts=Tt(),Ec=tr&&tr.prototype,Fh=Ch("species"),fs=!1,mc=Oh(kh.PromiseRejectionEvent),Mh=Ah("Promise",function(){var e=Ph(tr),r=e!==String(tr);if(!r&&Ts===66||Lh&&!(Ec.catch&&Ec.finally))return!0;if(!Ts||Ts<51||!/native code/.test(e)){var t=new tr(function(a){a(1)}),s=function(a){a(function(){},function(){})},n=t.constructor={};if(n[Fh]=s,fs=t.then(function(){})instanceof s,!fs)return!0}return!r&&(pc==="BROWSER"||pc==="DENO")&&!mc});hc.exports={CONSTRUCTOR:Mh,REJECTION_EVENT:mc,SUBCLASSING:fs}});var ne=i((DS,fc)=>{"use strict";var Tc=Y(),Uh=TypeError,Bh=function(e){var r,t;this.promise=new e(function(s,n){if(r!==void 0||t!==void 0)throw new Uh("Bad Promise constructor");r=s,t=n}),this.resolve=Tc(r),this.reject=Tc(t)};fc.exports.f=function(e){return new Bh(e)}});var Mc=i(()=>{"use strict";var qh=K(),xh=de(),Br=kr(),z=I(),Ie=P(),Rc=wr(),gc=$i(),jh=zi(),Gh=to(),Qh=Y(),Ur=_(),Wh=q(),Yh=no(),Hh=Io(),vc=us().set,ys=oc(),$h=uc(),Vh=Lr(),Kh=ds(),bc=Qt(),qr=he(),Ss=Te(),wc=ne(),xr="Promise",Dc=Ss.CONSTRUCTOR,zh=Ss.REJECTION_EVENT,Jh=Ss.SUBCLASSING,Rs=bc.getterFor(xr),Zh=bc.set,fe=qr&&qr.prototype,ae=qr,Fr=fe,Nc=z.TypeError,gs=z.document,vs=z.process,Is=wc.f,Xh=Is,eT=!!(gs&&gs.createEvent&&z.dispatchEvent),kc="unhandledrejection",rT="rejectionhandled",Ic=0,Oc=1,tT=2,bs=1,Ac=2,Mr,_c,sT,yc,Pc=function(e){var r;return Wh(e)&&Ur(r=e.then)?r:!1},Cc=function(e,r){var t=r.value,s=r.state===Oc,n=s?e.ok:e.fail,a=e.resolve,o=e.reject,u=e.domain,d,E,g;try{n?(s||(r.rejection===Ac&&aT(r),r.rejection=bs),n===!0?d=t:(u&&u.enter(),d=n(t),u&&(u.exit(),g=!0)),d===e.promise?o(new Nc("Promise-chain cycle")):(E=Pc(d))?Ie(E,d,a,o):a(d)):o(t)}catch(G){u&&!g&&u.exit(),o(G)}},Lc=function(e,r){e.notified||(e.notified=!0,ys(function(){for(var t=e.reactions,s;s=t.get();)Cc(s,e);e.notified=!1,r&&!e.rejection&&nT(e)}))},Fc=function(e,r,t){var s,n;eT?(s=gs.createEvent("Event"),s.promise=r,s.reason=t,s.initEvent(e,!1,!0),z.dispatchEvent(s)):s={promise:r,reason:t},!zh&&(n=z["on"+e])?n(s):e===kc&&$h("Unhandled promise rejection",t)},nT=function(e){Ie(vc,z,function(){var r=e.facade,t=e.value,s=Sc(e),n;if(s&&(n=Vh(function(){Br?vs.emit("unhandledRejection",t,r):Fc(kc,r,t)}),e.rejection=Br||Sc(e)?Ac:bs,n.error))throw n.value})},Sc=function(e){return e.rejection!==bs&&!e.parent},aT=function(e){Ie(vc,z,function(){var r=e.facade;Br?vs.emit("rejectionHandled",r):Fc(rT,r,e.value)})},Re=function(e,r,t){return function(s){e(r,s,t)}},ge=function(e,r,t){e.done||(e.done=!0,t&&(e=t),e.value=r,e.state=tT,Lc(e,!0))},_s=function(e,r,t){if(!e.done){e.done=!0,t&&(e=t);try{if(e.facade===r)throw new Nc("Promise can't be resolved itself");var s=Pc(r);s?ys(function(){var n={done:!1};try{Ie(s,r,Re(_s,n,e),Re(ge,n,e))}catch(a){ge(n,a,e)}}):(e.value=r,e.state=Oc,Lc(e,!1))}catch(n){ge({done:!1},n,e)}}};if(Dc&&(ae=function(r){Yh(this,Fr),Qh(r),Ie(Mr,this);var t=Rs(this);try{r(Re(_s,t),Re(ge,t))}catch(s){ge(t,s)}},Fr=ae.prototype,Mr=function(r){Zh(this,{type:xr,done:!1,notified:!1,parent:!1,reactions:new Kh,rejection:!1,state:Ic,value:null})},Mr.prototype=Rc(Fr,"then",function(r,t){var s=Rs(this),n=Is(Hh(this,ae));return s.parent=!0,n.ok=Ur(r)?r:!0,n.fail=Ur(t)&&t,n.domain=Br?vs.domain:void 0,s.state===Ic?s.reactions.add(n):ys(function(){Cc(n,s)}),n.promise}),_c=function(){var e=new Mr,r=Rs(e);this.promise=e,this.resolve=Re(_s,r),this.reject=Re(ge,r)},wc.f=Is=function(e){return e===ae||e===sT?new _c(e):Xh(e)},!xh&&Ur(qr)&&fe!==Object.prototype)){yc=fe.then,Jh||Rc(fe,"then",function(r,t){var s=this;return new ae(function(n,a){Ie(yc,s,n,a)}).then(r,t)},{unsafe:!0});try{delete fe.constructor}catch{}gc&&gc(fe,Fr)}qh({global:!0,constructor:!0,wrap:!0,forced:Dc},{Promise:ae});jh(ae,xr,!1,!0);Gh(xr)});var ws=i((OS,Uc)=>{"use strict";Uc.exports={}});var qc=i((AS,Bc)=>{"use strict";var iT=L(),oT=ws(),cT=iT("iterator"),uT=Array.prototype;Bc.exports=function(e){return e!==void 0&&(oT.Array===e||uT[cT]===e)}});var Ds=i((PS,jc)=>{"use strict";var dT=Zt(),xc=fr(),lT=He(),pT=ws(),ET=L(),mT=ET("iterator");jc.exports=function(e){if(!lT(e))return xc(e,mT)||xc(e,"@@iterator")||pT[dT(e)]}});var Qc=i((CS,Gc)=>{"use strict";var hT=P(),TT=Y(),fT=V(),RT=$e(),gT=Ds(),IT=TypeError;Gc.exports=function(e,r){var t=arguments.length<2?gT(e):r;if(TT(t))return fT(hT(t,e));throw new IT(RT(e)+" is not iterable")}});var Hc=i((LS,Yc)=>{"use strict";var _T=P(),Wc=V(),yT=fr();Yc.exports=function(e,r,t){var s,n;Wc(e);try{if(s=yT(e,"return"),!s){if(r==="throw")throw t;return t}s=_T(s,e)}catch(a){n=!0,s=a}if(r==="throw")throw t;if(n)throw s;return Wc(s),t}});var Ns=i((FS,zc)=>{"use strict";var ST=Ar(),vT=P(),bT=V(),wT=$e(),DT=qc(),NT=Vt(),$c=hr(),kT=Qc(),OT=Ds(),Vc=Hc(),AT=TypeError,jr=function(e,r){this.stopped=e,this.result=r},Kc=jr.prototype;zc.exports=function(e,r,t){var s=t&&t.that,n=!!(t&&t.AS_ENTRIES),a=!!(t&&t.IS_RECORD),o=!!(t&&t.IS_ITERATOR),u=!!(t&&t.INTERRUPTED),d=ST(r,s),E,g,G,v,f,Q,Gs,Qs=function(N){return E&&Vc(E,"normal",N),new jr(!0,N)},Ws=function(N){return n?(bT(N),u?d(N[0],N[1],Qs):d(N[0],N[1])):u?d(N,Qs):d(N)};if(a)E=e.iterator;else if(o)E=e;else{if(g=OT(e),!g)throw new AT(wT(e)+" is not iterable");if(DT(g)){for(G=0,v=NT(e);v>G;G++)if(f=Ws(e[G]),f&&$c(Kc,f))return f;return new jr(!1)}E=kT(e,g)}for(Q=a?e.next:E.next;!(Gs=vT(Q,E)).done;){try{f=Ws(Gs.value)}catch(N){Vc(E,"throw",N)}if(typeof f=="object"&&f&&$c(Kc,f))return f}return new jr(!1)}});var ru=i((MS,eu)=>{"use strict";var PT=L(),Zc=PT("iterator"),Xc=!1;try{Jc=0,ks={next:function(){return{done:!!Jc++}},return:function(){Xc=!0}},ks[Zc]=function(){return this},Array.from(ks,function(){throw 2})}catch{}var Jc,ks;eu.exports=function(e,r){try{if(!r&&!Xc)return!1}catch{return!1}var t=!1;try{var s={};s[Zc]=function(){return{next:function(){return{done:t=!0}}}},e(s)}catch{}return t}});var Os=i((US,tu)=>{"use strict";var CT=he(),LT=ru(),FT=Te().CONSTRUCTOR;tu.exports=FT||!LT(function(e){CT.all(e).then(void 0,function(){})})});var su=i(()=>{"use strict";var MT=K(),UT=P(),BT=Y(),qT=ne(),xT=Lr(),jT=Ns(),GT=Os();MT({target:"Promise",stat:!0,forced:GT},{all:function(r){var t=this,s=qT.f(t),n=s.resolve,a=s.reject,o=xT(function(){var u=BT(t.resolve),d=[],E=0,g=1;jT(r,function(G){var v=E++,f=!1;g++,UT(u,t,G).then(function(Q){f||(f=!0,d[v]=Q,--g||n(d))},a)}),--g||n(d)});return o.error&&a(o.value),s.promise}})});var au=i(()=>{"use strict";var QT=K(),WT=de(),YT=Te().CONSTRUCTOR,Ps=he(),HT=$(),$T=_(),VT=wr(),nu=Ps&&Ps.prototype;QT({target:"Promise",proto:!0,forced:YT,real:!0},{catch:function(e){return this.then(void 0,e)}});!WT&&$T(Ps)&&(As=HT("Promise").prototype.catch,nu.catch!==As&&VT(nu,"catch",As,{unsafe:!0}));var As});var iu=i(()=>{"use strict";var KT=K(),zT=P(),JT=Y(),ZT=ne(),XT=Lr(),ef=Ns(),rf=Os();KT({target:"Promise",stat:!0,forced:rf},{race:function(r){var t=this,s=ZT.f(t),n=s.reject,a=XT(function(){var o=JT(t.resolve);ef(r,function(u){zT(o,t,u).then(s.resolve,n)})});return a.error&&n(a.value),s.promise}})});var ou=i(()=>{"use strict";var tf=K(),sf=ne(),nf=Te().CONSTRUCTOR;tf({target:"Promise",stat:!0,forced:nf},{reject:function(r){var t=sf.f(this),s=t.reject;return s(r),t.promise}})});var uu=i((HS,cu)=>{"use strict";var af=V(),of=q(),cf=ne();cu.exports=function(e,r){if(af(e),of(r)&&r.constructor===e)return r;var t=cf.f(e),s=t.resolve;return s(r),t.promise}});var pu=i(()=>{"use strict";var uf=K(),df=$(),du=de(),lf=he(),lu=Te().CONSTRUCTOR,pf=uu(),Ef=df("Promise"),mf=du&&!lu;uf({target:"Promise",stat:!0,forced:du||lu},{resolve:function(r){return pf(mf&&this===Ef?lf:this,r)}})});var Eu=i(()=>{"use strict";Mc();su();au();iu();ou();pu()});var Cs=i(()=>{"use strict";var hf=K(),Tf=ne();hf({target:"Promise",stat:!0},{withResolvers:function(){var r=Tf.f(this);return{promise:r.promise,resolve:r.resolve,reject:r.reject}}})});var hu=i((XS,mu)=>{"use strict";var ff=I();mu.exports=ff});var Ru=i((ev,fu)=>{"use strict";Eu();Cs();var Rf=P(),gf=_(),If=hu(),Tu=If.Promise,_f=Tu.withResolvers;fu.exports=function(){return Rf(_f,gf(this)?this:Tu)}});var Iu=i((rv,gu)=>{"use strict";var yf=Ru();gu.exports=yf});var _u=i(()=>{"use strict";Cs()});var Su=i((nv,yu)=>{"use strict";var Sf=Iu();_u();yu.exports=Sf});var W=class{singleValue(){let{columnCount:r,rowCount:t}=this;if(r===0)throw Error("no column data");if(t===0)throw Error("no rows");if(r>1)throw Error("more than one column");if(t>1)throw Error("more than one row");return this.value(0,0)}columnNames(){let{columnCount:r}=this,t=[];for(let s=0;s<r;s++)t.push(this.columnName(s));return t}deduplicatedColumnNames(){let{columnCount:r}=this,t=[],s={};for(let n=0;n<r;n++){let a=this.columnName(n),o=(s[a]||0)+1;s[a]=o,o>1?t.push(`${a}:${o-1}`):t.push(a)}return t}toRows(){let{rowCount:r,columnCount:t}=this,s=this.deduplicatedColumnNames(),n=[];for(let a=0;a<r;a++){let o={};for(let u=0;u<t;u++)o[s[u]]=this.value(u,a);n.push(o)}return n}};var ee=class extends W{iterator;iteratorDone=!1;totalRowsRead=0;batches=[];batchSizeRuns=[];constructor(r){super(),this.iterator=r}get columnCount(){return this.batches.length===0?0:this.batches[0].columnCount}get rowCount(){return this.totalRowsRead}columnName(r){if(this.batches.length===0)throw Error("no column data");return this.batches[0].columnName(r)}columnType(r){if(this.batches.length===0)throw Error("no column data");return this.batches[0].columnType(r)}value(r,t){if(this.totalRowsRead===0)throw Error("no data");let s=0,n=t;for(let a of this.batchSizeRuns){if(n<a.rowCount){s+=Math.floor(n/a.batchSize);let o=n%a.batchSize;return this.batches[s].value(r,o)}s+=a.batchCount,n-=a.rowCount}throw Error(`Row index ${t} requested, but only ${this.totalRowsRead} row have been read so far.`)}get done(){return this.iteratorDone}async readAll(){return this.read()}async readUntil(r){return this.read(r)}async read(r){for(;!(this.iteratorDone||r!==void 0&&this.totalRowsRead>=r);){let{value:t,done:s}=await this.iterator.next();t&&(this.updateBatchSizeRuns(t),this.batches.push(t),this.totalRowsRead+=t.rowCount),s&&(this.iteratorDone=s)}}updateBatchSizeRuns(r){if(this.batchSizeRuns.length>0){let t=this.batchSizeRuns[this.batchSizeRuns.length-1];if(t.batchSize===r.rowCount){t.batchCount+=1,t.rowCount+=t.batchSize;return}}this.batchSizeRuns.push({batchCount:1,batchSize:r.rowCount,rowCount:r.rowCount})}};var Hs=class extends W{columns;values;constructor(r,t){super(),this.columns=r,this.values=t}get columnCount(){return this.columns.length}get rowCount(){return this.values.length>0?this.values[0].length:0}columnName(r){return this.columns[r].name}columnType(r){return this.columns[r].type}value(r,t){return this.values[r][t]}};var c=class e{constructor(){}static ARRAY(r,t){return{name:"ARRAY",valueType:r,length:t}}static BIGINT={name:"BIGINT"};static BIT={name:"BIT"};static BOOLEAN={name:"BOOLEAN"};static BLOB={name:"BLOB"};static DATE={name:"DATE"};static DOUBLE={name:"DOUBLE"};static default_DECIMAL={name:"DECIMAL"};static DECIMAL(r,t){return r===void 0&&t===void 0?e.default_DECIMAL:{name:"DECIMAL",width:r,scale:t}}static ENUM={name:"ENUM"};static GEOMETRY={name:"GEOMETRY"};static HUGEINT={name:"HUGEINT"};static INTEGER={name:"INTEGER"};static INTERVAL={name:"INTERVAL"};static JSON={name:"JSON"};static LIST(r){return{name:"LIST",valueType:r}}static MAP(r,t){return{name:"MAP",keyType:r,valueType:t}}static REAL={name:"REAL"};static SMALLINT={name:"SMALLINT"};static SQLNULL={name:"SQLNULL"};static STRUCT(r){return{name:"STRUCT",entries:r}}static STRUCT_entry(r,t){return{key:r,valueType:t}}static TIME={name:"TIME"};static TIME_TZ={name:"TIME_TZ"};static TIMESTAMP={name:"TIMESTAMP"};static TIMESTAMP_S={name:"TIMESTAMP_S"};static TIMESTAMP_MS={name:"TIMESTAMP_MS"};static TIMESTAMP_NS={name:"TIMESTAMP_NS"};static TIMESTAMP_TZ={name:"TIMESTAMP_TZ"};static TINYINT={name:"TINYINT"};static UBIGINT={name:"UBIGINT"};static UHUGEINT={name:"UHUGEINT"};static UINTEGER={name:"UINTEGER"};static USMALLINT={name:"USMALLINT"};static UTINYINT={name:"UTINYINT"};static UUID={name:"UUID"};static UNION(r){return{name:"UNION",alternatives:r}}static UNION_alternative(r,t){return{tag:r,valueType:t}}static VARCHAR={name:"VARCHAR"};static VARCHAR_withLength(r){return{name:"VARCHAR",length:r}}static WKB_BLOB={name:"WKB_BLOB"}};function re(e){switch(e.name){case"ARRAY":return`${re(e.valueType)}[${e.length}]`;case"DECIMAL":return!e.width&&!e.scale?"DECIMAL(18, 3)":e.scale?`DECIMAL(${e.width}, ${e.scale})`:`DECIMAL(${e.width}, 0)`;case"LIST":return`${re(e.valueType)}[]`;case"MAP":return`MAP(${re(e.keyType)}, ${re(e.valueType)})`;case"SQLNULL":return'"NULL"';case"STRUCT":return`STRUCT(${e.entries.map(({key:r,valueType:t})=>`${r} ${re(t)}`).join(", ")})`;case"UNION":return`UNION(${e.alternatives.map(({tag:r,valueType:t})=>`${r} ${re(t)}`).join(", ")})`;case"REAL":return"FLOAT";case"BIGINT":case"BIT":case"BOOLEAN":case"BLOB":case"DATE":case"DOUBLE":case"ENUM":case"GEOMETRY":case"HUGEINT":case"INTEGER":case"INTERVAL":case"JSON":case"SMALLINT":case"TIME":case"TIME_TZ":case"TIMESTAMP":case"TIMESTAMP_S":case"TIMESTAMP_MS":case"TIMESTAMP_NS":case"TIMESTAMP_TZ":case"TINYINT":case"UBIGINT":case"UHUGEINT":case"UINTEGER":case"USMALLINT":case"UTINYINT":case"UUID":case"VARCHAR":case"WKB_BLOB":default:return e.name}}var $s={BIGINT:c.BIGINT,BIT:c.BIT,BOOLEAN:c.BOOLEAN,BLOB:c.BLOB,DATE:c.DATE,DOUBLE:c.DOUBLE,ENUM:c.ENUM,GEOMETRY:c.GEOMETRY,HUGEINT:c.HUGEINT,INTEGER:c.INTEGER,INTERVAL:c.INTERVAL,JSON:c.JSON,FLOAT:c.REAL,SMALLINT:c.SMALLINT,SQLNULL:c.SQLNULL,TIME:c.TIME,TIMESTAMP:c.TIMESTAMP,TIMESTAMP_S:c.TIMESTAMP_S,TIMESTAMP_MS:c.TIMESTAMP_MS,TIMESTAMP_NS:c.TIMESTAMP_NS,TINYINT:c.TINYINT,UBIGINT:c.UBIGINT,UHUGEINT:c.UHUGEINT,UINTEGER:c.UINTEGER,USMALLINT:c.USMALLINT,UTINYINT:c.UTINYINT,UUID:c.UUID,VARCHAR:c.VARCHAR,WKB_BLOB:c.WKB_BLOB,"TIMESTAMP WITH TIME ZONE":c.TIMESTAMP_TZ,"TIME WITH TIME ZONE":c.TIME_TZ};function Gu(e){e=e.trim();let r=Qu(e);if(r){if(e.startsWith("STRUCT"))return c.STRUCT(r);if(e.startsWith("MAP")){let[t,s]=r;return c.MAP(t.valueType,s.valueType)}if(e.startsWith("UNION"))return c.UNION(r.map(t=>({tag:t.key,valueType:t.valueType})))}}function Qu(e){let t=/^(STRUCT|MAP|UNION)\s*\((.*)\)$/.exec(e);if(!t)return;let s=t[2];return Wu(s)}function Wu(e){let r=[],t=null,s=0,n=0;for(let a=0;a<e.length;a++){let o=e[a];if(t===null&&o!=="("&&o!==")"&&o!==","&&(t=a),o==='"'&&n++,o===","&&s===0&&n%2===0&&t!==null){let u=e.slice(t,a);r.push(Vs(u.trim())),t=null}else o==="("&&n%2===0&&s++,o===")"&&n%2===0&&s--}if(t!==null){let a=e.slice(t);r.push(Vs(a.trim()))}return r}function Vs(e){let t=/^(".*?"|\w+)\s+(.+)$/.exec(e);if(t){let s=t[1],n=ve(t[2].trim());return{key:s,valueType:n}}else return{key:"",valueType:ve(e)}}function Yu(e){let r=e.match(/^DECIMAL\((\d+),(\d+)\)$/);if(r)return c.DECIMAL(Number(r[1]),Number(r[2]))}function Hu(e){if(e.startsWith("ENUM"))return c.ENUM}function $u(e){if(e.endsWith("[]")){let r=e.slice(0,-2);return c.LIST(ve(r))}}function Vu(e){let r=e.match(/\[(\d+)\]$/);if(r){let t=e.slice(0,-r[0].length),s=r[1];return c.ARRAY(ve(t),Number(s))}}function ve(e){if(e in $s)return $s[e];let r=$u(e);if(r)return r;let t=Vu(e);if(t)return t;let s=Yu(e);if(s)return s;let n=Hu(e);if(n)return n;let a=Gu(e);if(a)return a;throw Error(`unimplemented type match: ${e}`)}function k(e){return e==null?"NULL":typeof e=="string"?`'${e.replace("'","''")}'`:String(e)}var m=class{toString(){return this.toDuckDBString()}};function H(e){return e===null?null:e instanceof m?e.toJS():e}var be=class extends m{values;constructor(r){super(),this.values=r}toDuckDBString(){return`[${this.values.map(k).join(", ")}]`}toJS(){return this.values.map(H)}};function Ks(e){let r="";for(let t of e)t<=31||t===34||t===39||t>=127?r+=`\\x${t.toString(16).toUpperCase().padStart(2,"0")}`:r+=String.fromCharCode(t);return r}var we=class extends m{bytes;constructor(r){super(),this.bytes=r}toDuckDBString(){return Ks(this.bytes)}toJS(){return this.bytes}};var Hr=BigInt(1e6),Ku=BigInt(1e3),zu=BigInt(1e3),zs=BigInt(60),Js=BigInt(60),nr=BigInt(864e8),Ju=BigInt("-9223372036854775807"),Zu=BigInt("9223372036854775807");function Xu(e,r,t){let s=String(Math.abs(e)).padStart(4,"0"),n=String(r).padStart(2,"0"),a=String(t).padStart(2,"0");return`${s}-${n}-${a}${e<0?" (BC)":""}`}function $r(e){let r=Math.abs(e),t=e<0?-1:1,s=Math.floor(r/146097),n=t*s*400,a=r%146097,o=t*a*864e5,u=new Date(o),d=n+u.getUTCFullYear();d<0&&d--;let E=u.getUTCMonth()+1,g=u.getUTCDate();return Xu(d,E,g)}function ed(e,r,t,s){let n=String(e).padStart(2,"0"),a=String(r).padStart(2,"0"),o=String(t).padStart(2,"0"),u=String(s).padStart(6,"0").replace(/0+$/,"");return`${n}:${a}:${o}${u.length>0?`.${u}`:""}`}function Zs(e){let r=e%Hr,t=e/Hr,s=t%zs,n=t/zs,a=n%Js,o=n/Js;return ed(o,a,s,r)}function Vr(e){let r=e<0?e+nr:e;return Zs(r)}function rd(e){let r=e<0,t=r?-e:e,s=Zs(t);return r?`-${s}`:s}function td(e,r,t){let s=$r(Number(e)),n=Vr(r),a=t?` ${t}`:"";return`${s} ${n}${a}`}function De(e,r){if(e===Ju)return"-infinity";if(e===Zu)return"infinity";let t=e/nr,s=e%nr;return s<0&&(t--,s+=nr),td(t,s,r)}function Xs(e,r){return De(e*Hr,r)}function en(e,r){return De(e*Ku,r)}function rn(e,r){return De(e/zu,r)}function Yr(e,r){return`${e} ${r}${e!==1?"s":""}`}function tn(e,r,t){let s=[];if(e!==0){let n=e<0?-1:1,a=Math.abs(e),o=Math.floor(a/12),u=n*o,d=n*(a-o*12);u!==0&&s.push(Yr(u,"year")),d!==0&&s.push(Yr(d,"month"))}return r!==0&&s.push(Yr(r,"day")),t!==BigInt(0)&&s.push(rd(t)),s.length>0?s.join(" "):"00:00:00"}var Ne=class extends m{days;constructor(r){super(),this.days=r}toDuckDBString(){return $r(this.days)}toJS(){return this.toDuckDBString()}};function sd(e){return new Intl.NumberFormat(e,{useGrouping:!1}).formatToParts(.1).find(t=>t.type==="decimal")?.value??"."}var Kr={};function nd(e){let r=JSON.stringify(e);if(r in Kr)return Kr[r];let t=sd(e);return Kr[r]=t,t}function ad(e,r){if(e){let{minimumFractionDigits:t,maximumFractionDigits:s,...n}=e.options??{};return r.toLocaleString(e?.locales,n)}return String(r)}function id(e,r,t){let s=String(r).padStart(t,"0");if(!e)return s;let n=e?.options?.minimumFractionDigits??0,a=e?.options?.maximumFractionDigits??20;return s.padEnd(n,"0").slice(0,a)}function zr(e,r,t){if(r>0){let s=BigInt(10)**BigInt(r),n=e<0?-e:e,a=e<0?"-":"",o=n/s,u=ad(t,o),d=n%s,E=id(t,d,r),g=t?nd(t.locales):".";return`${a}${u}${g}${E}`}return t?e.toLocaleString(t?.locales,t?.options):String(e)}var ke=class extends m{scaledValue;scale;constructor(r,t){super(),this.scaledValue=r,this.scale=t}toDuckDBString(){return zr(this.scaledValue,this.scale)}toLocaleString(r,t){return zr(this.scaledValue,this.scale,{locales:r,options:t})}toJS(){return this.toDuckDBString()}};var Oe=class extends m{months;days;microseconds;constructor(r,t,s){super(),this.months=r,this.days=t,this.microseconds=s}toDuckDBString(){return tn(this.months,this.days,this.microseconds)}toJS(){return this.toDuckDBString()}};var Ae=class extends m{values;constructor(r){super(),this.values=r}toDuckDBString(){return`[${this.values.map(k).join(", ")}]`}toJS(){return this.values.map(H)}};var Pe=class extends m{entries;constructor(r){super(),this.entries=r}toDuckDBString(){return`{${this.entries.map(({key:t,value:s})=>`${k(t)}: ${k(s)}`).join(", ")}}`}toJS(){let r={};for(let{key:t,value:s}of this.entries){let n=k(t);r[n]=H(s)}return r}};var Ce=class extends m{entries;constructor(r){super(),this.entries=r}toDuckDBString(){return`{${this.entries.map(({key:t,value:s})=>`${k(t)}: ${k(s)}`).join(", ")}}`}toJS(){let r={};for(let{key:t,value:s}of this.entries){let n=k(t);r[n]=H(s)}return r}};var Le=class extends m{microseconds;constructor(r){super(),this.microseconds=r}toDuckDBString(){return Vr(this.microseconds)}toJS(){return this.toDuckDBString()}};var Fe=class extends m{microseconds;timezone;constructor(r,t){super(),this.microseconds=r,this.timezone=t}toDuckDBString(){return De(this.microseconds,this.timezone)}toJS(){return this.toDuckDBString()}};var Me=class extends m{milliseconds;constructor(r){super(),this.milliseconds=r}toDuckDBString(){return en(this.milliseconds)}toJS(){return this.toDuckDBString()}};var Ue=class extends m{nanoseconds;constructor(r){super(),this.nanoseconds=r}toDuckDBString(){return rn(this.nanoseconds)}toJS(){return this.toDuckDBString()}};var Be=class extends m{seconds;constructor(r){super(),this.seconds=r}toDuckDBString(){return Xs(this.seconds)}toJS(){return this.toDuckDBString()}};function ie(e,r,t){r===void 0&&(r=0),t===void 0&&(t=e.length);let s="";for(let n=r;n<t;n++){let a=e[n];s+=(a<16?"0":"")+a.toString(16)}return s}var qe=class extends m{bytes;constructor(r){super(),this.bytes=r}toDuckDBString(){if(this.bytes.length!==16)throw new Error("Invalid UUID bytes length");return`${ie(this.bytes,0,4)}-${ie(this.bytes,4,6)}-${ie(this.bytes,6,8)}-${ie(this.bytes,8,10)}-${ie(this.bytes,10,16)}`}toJS(){return this.toDuckDBString()}};function xe(e,r){return r.length===0?e:e.endsWith("/")?`${e}${r}`:`${e}/${r}`}function od(e){return typeof e?.version=="string"}async function ar(e){let t=await(await fetch(xe(e.href,"version"))).json();if(!od(t))throw new Error(`Unexpected version information: ${JSON.stringify(t)}`);let{version:s}=t;return s}async function sn(){return new Promise(e=>{let r=URL.createObjectURL(new Blob(["self.postMessage({ canCreateWorker: !!self.Worker });"],{type:"application/javascript"})),t=new Worker(r);URL.revokeObjectURL(r),t.addEventListener("message",s);function s(n){t.removeEventListener("message",s),t.terminate(),e(!!n.data.canCreateWorker)}})}function nn(e,r){return xe(xe(e.href,r),"duckdb-wasm")}var an="MD_EVENT";var oe;(function(e){e.CATALOG_CHANGE_EVENT="CatalogChangeEvent"})(oe||(oe={}));var ir=class extends CustomEvent{constructor(r,t){super(r,{detail:t})}},je=class extends ir{constructor(r){super(oe.CATALOG_CHANGE_EVENT,r)}};function on(e){switch(e.data?.name){case oe.CATALOG_CHANGE_EVENT:return new je(e.data);default:return null}}async function cd(e){return(await e.query("from MD_IS_NETWORK_READY();")).toArray()[0].Success}async function cn(e){for(let r=0;r<1e3;++r){if(await cd(e))return;await new Promise(t=>setTimeout(t,10))}throw new Error("Could not initialize worker after 10 seconds.")}async function un(e){let{instance:r,logLevel:t,skipWelcomePack:s,token:n}=e,a=e.extensionRepositoryUrlPrefix||new URL("https://app.motherduck.com"),o=e.apiUrl||new URL("https://api.motherduck.com"),u=e.extensionVersion??await ar(a),d=nn(a,u),E=r._worker;E&&E.addEventListener("message",f=>{if(f.data?.type!==an)return;let Q=on(f);Q?globalThis.dispatchEvent(Q):console.warn(`Unrecognized MD_EVENT, name=${f.data?.name}`)}),!(!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||await sn())&&E&&E.addEventListener("message",f=>{if(f&&f.data&&f.data.type==="Initialize"){let Q=new Worker(f.data.workerUrl);URL.revokeObjectURL(f.data.workerUrl),Q.postMessage(f.data,[f.data.port])}});let v=await r.connect();try{await v.query(`SET custom_extension_repository="${d}";`),await v.query("LOAD motherduck;"),await v.query("RESET custom_extension_repository;"),await v.query(`SET motherduck_host='${o.hostname}';`),o.port&&await v.query(`SET motherduck_port='${o.port}';`),o.protocol==="http:"&&await v.query("SET motherduck_use_tls=false;"),await v.query(`SET motherduck_token='${n}';`),await cn(v),t&&await v.query(`SET motherduck_log_level='${t}';`),s||await v.query("PRAGMA MD_USE_DEFAULT")}finally{await v.close()}}var Ge;(function(e){e.NONE="none",e.ERROR="error",e.INFO="info",e.DEBUG="debug",e.TRACE="trace"})(Ge||(Ge={}));import*as M from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";import*as l from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";var ud=Object.create,dn=Object.defineProperty,dd=Object.getOwnPropertyDescriptor,ld=Object.getOwnPropertyNames,pd=Object.getPrototypeOf,Ed=Object.prototype.hasOwnProperty,md=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),hd=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of ld(r))!Ed.call(e,n)&&n!==t&&dn(e,n,{get:()=>r[n],enumerable:!(s=dd(r,n))||s.enumerable});return e},Td=(e,r,t)=>(t=e!=null?ud(pd(e)):{},hd(r||!e||!e.__esModule?dn(t,"default",{value:e,enumerable:!0}):t,e)),fd=md((e,r)=>{r.exports=Worker}),Rd=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(Rd||{}),ln=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(ln||{}),cr=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(cr||{}),gd=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(gd||{}),Id=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(Id||{}),_d=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(_d||{});var yd=(e=>(e[e.SUCCESS=0]="SUCCESS",e))(yd||{}),Sd=class{constructor(e,r){this._bindings=e,this._conn=r}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let r=await this._bindings.runQuery(this._conn,e),t=M.RecordBatchReader.from(r);return console.assert(t.isSync(),"Reader is not sync"),console.assert(t.isFile(),"Reader is not file"),new M.Table(t)}async send(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let r=await this._bindings.startPendingQuery(this._conn,e);for(;r==null;)r=await this._bindings.pollPendingQuery(this._conn);let t=new pn(this._bindings,this._conn,r),s=await M.RecordBatchReader.from(t);return console.assert(s.isAsync()),console.assert(s.isStream()),s}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let r=await this._bindings.createPrepared(this._conn,e);return new En(this._bindings,this._conn,r)}async insertArrowTable(e,r){let t=M.tableToIPC(e,"stream");await this.insertArrowFromIPCStream(t,r)}async insertArrowFromIPCStream(e,r){await this._bindings.insertArrowFromIPCStream(this._conn,e,r)}async insertCSVFromPath(e,r){await this._bindings.insertCSVFromPath(this._conn,e,r)}async insertJSONFromPath(e,r){await this._bindings.insertJSONFromPath(this._conn,e,r)}},pn=class{constructor(e,r,t){this.db=e,this.conn=r,this.header=t,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return this._inFlight!=null?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},En=class{constructor(e,r,t){this.bindings=e,this.connectionId=r,this.statementId=t}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let r=await this.bindings.runPrepared(this.connectionId,this.statementId,e),t=M.RecordBatchReader.from(r);return console.assert(t.isSync()),console.assert(t.isFile()),new M.Table(t)}async send(...e){let r=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),t=new pn(this.bindings,this.connectionId,r),s=await M.RecordBatchReader.from(t);return console.assert(s.isAsync()),console.assert(s.isStream()),s}},vd=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(vd||{}),bd=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(bd||{}),h=class{constructor(e,r){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=r,this.promise=new Promise((t,s)=>{this.promiseResolver=t,this.promiseRejecter=s})}};function or(e){switch(e.typeId){case l.Type.Binary:return{sqlType:"binary"};case l.Type.Bool:return{sqlType:"bool"};case l.Type.Date:return{sqlType:"date"};case l.Type.DateDay:return{sqlType:"date32[d]"};case l.Type.DateMillisecond:return{sqlType:"date64[ms]"};case l.Type.Decimal:{let r=e;return{sqlType:"decimal",precision:r.precision,scale:r.scale}}case l.Type.Float:return{sqlType:"float"};case l.Type.Float16:return{sqlType:"float16"};case l.Type.Float32:return{sqlType:"float32"};case l.Type.Float64:return{sqlType:"float64"};case l.Type.Int:return{sqlType:"int32"};case l.Type.Int16:return{sqlType:"int16"};case l.Type.Int32:return{sqlType:"int32"};case l.Type.Int64:return{sqlType:"int64"};case l.Type.Uint16:return{sqlType:"uint16"};case l.Type.Uint32:return{sqlType:"uint32"};case l.Type.Uint64:return{sqlType:"uint64"};case l.Type.Uint8:return{sqlType:"uint8"};case l.Type.IntervalDayTime:return{sqlType:"interval[dt]"};case l.Type.IntervalYearMonth:return{sqlType:"interval[m]"};case l.Type.List:return{sqlType:"list",valueType:or(e.valueType)};case l.Type.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case l.Type.Null:return{sqlType:"null"};case l.Type.Utf8:return{sqlType:"utf8"};case l.Type.Struct:return{sqlType:"struct",fields:e.children.map(r=>Jr(r.name,r.type))};case l.Type.Map:{let r=e;return{sqlType:"map",keyType:or(r.keyType),valueType:or(r.valueType)}}case l.Type.Time:return{sqlType:"time[s]"};case l.Type.TimeMicrosecond:return{sqlType:"time[us]"};case l.Type.TimeMillisecond:return{sqlType:"time[ms]"};case l.Type.TimeNanosecond:return{sqlType:"time[ns]"};case l.Type.TimeSecond:return{sqlType:"time[s]"};case l.Type.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case l.Type.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case l.Type.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case l.Type.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case l.Type.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function Jr(e,r){let t=or(r);return t.name=e,t}var wd=new TextEncoder,Dd=class{constructor(e,r=null){this._onInstantiationProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),r!=null&&this.attach(r)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((r,t)=>{this._workerShutdownResolver=r})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,r=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let t=this._nextMessageId++;return this._pendingRequests.set(t,e),this._worker.postMessage({messageId:t,type:e.type,data:e.data},r),await e.promise}onMessage(e){var r;let t=e.data;switch(t.type){case"LOG":{this._logger.log(t.data);return}case"INSTANTIATE_PROGRESS":{for(let n of this._onInstantiationProgress)n(t.data);return}}let s=this._pendingRequests.get(t.requestId);if(!s){console.warn("unassociated response: [".concat(t.requestId,", ").concat(t.type.toString(),"]"));return}if(this._pendingRequests.delete(t.requestId),t.type=="ERROR"){let n=new Error(t.data.message);n.name=t.data.name,(r=Object.getOwnPropertyDescriptor(n,"stack"))!=null&&r.writable&&(n.stack=t.data.stack),s.promiseRejecter(n);return}switch(s.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(t.type=="OK"){s.promiseResolver(t.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],t.type=="OK"){s.promiseResolver(t.data);return}break;case"GLOB_FILE_INFOS":if(t.type=="FILE_INFOS"){s.promiseResolver(t.data);return}break;case"GET_VERSION":if(t.type=="VERSION_STRING"){s.promiseResolver(t.data);return}break;case"GET_FEATURE_FLAGS":if(t.type=="FEATURE_FLAGS"){s.promiseResolver(t.data);return}break;case"GET_TABLE_NAMES":if(t.type=="TABLE_NAMES"){s.promiseResolver(t.data);return}break;case"TOKENIZE":if(t.type=="SCRIPT_TOKENS"){s.promiseResolver(t.data);return}break;case"COPY_FILE_TO_BUFFER":if(t.type=="FILE_BUFFER"){s.promiseResolver(t.data);return}break;case"EXPORT_FILE_STATISTICS":if(t.type=="FILE_STATISTICS"){s.promiseResolver(t.data);return}break;case"CONNECT":if(t.type=="CONNECTION_INFO"){s.promiseResolver(t.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(t.type=="QUERY_RESULT"){s.promiseResolver(t.data);return}break;case"SEND_PREPARED":if(t.type=="QUERY_RESULT_HEADER"){s.promiseResolver(t.data);return}break;case"START_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){s.promiseResolver(t.data);return}break;case"POLL_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){s.promiseResolver(t.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],t.type=="SUCCESS"){s.promiseResolver(t.data);return}break;case"FETCH_QUERY_RESULTS":if(t.type=="QUERY_RESULT_CHUNK"){s.promiseResolver(t.data);return}break;case"CREATE_PREPARED":if(t.type=="PREPARED_STATEMENT_ID"){s.promiseResolver(t.data);return}break}s.promiseRejecter(new Error("unexpected response type: ".concat(t.type.toString())))}onError(e){console.error(e),console.error("error in duckdb worker: ".concat(e.message)),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"));return}this._pendingRequests.clear()}async reset(){let e=new h("RESET",null);return await this.postTask(e)}async ping(){let e=new h("PING",null);await this.postTask(e)}async dropFile(e){let r=new h("DROP_FILE",e);return await this.postTask(r)}async dropFiles(){let e=new h("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new h("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,r=null,t=s=>{}){this._onInstantiationProgress.push(t);let s=new h("INSTANTIATE",[e,r]);return await this.postTask(s)}async getVersion(){let e=new h("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new h("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let r=new h("OPEN",e);await this.postTask(r)}async tokenize(e){let r=new h("TOKENIZE",e);return await this.postTask(r)}async connectInternal(){let e=new h("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new Sd(this,e)}async disconnect(e){let r=new h("DISCONNECT",e);await this.postTask(r)}async runQuery(e,r){let t=new h("RUN_QUERY",[e,r]);return await this.postTask(t)}async startPendingQuery(e,r){let t=new h("START_PENDING_QUERY",[e,r]);return await this.postTask(t)}async pollPendingQuery(e){let r=new h("POLL_PENDING_QUERY",e);return await this.postTask(r)}async cancelPendingQuery(e){let r=new h("CANCEL_PENDING_QUERY",e);return await this.postTask(r)}async fetchQueryResults(e){let r=new h("FETCH_QUERY_RESULTS",e);return await this.postTask(r)}async getTableNames(e,r){let t=new h("GET_TABLE_NAMES",[e,r]);return await this.postTask(t)}async createPrepared(e,r){let t=new h("CREATE_PREPARED",[e,r]);return await this.postTask(t)}async closePrepared(e,r){let t=new h("CLOSE_PREPARED",[e,r]);await this.postTask(t)}async runPrepared(e,r,t){let s=new h("RUN_PREPARED",[e,r,t]);return await this.postTask(s)}async sendPrepared(e,r,t){let s=new h("SEND_PREPARED",[e,r,t]);return await this.postTask(s)}async globFiles(e){let r=new h("GLOB_FILE_INFOS",e);return await this.postTask(r)}async registerFileText(e,r){let t=wd.encode(r);await this.registerFileBuffer(e,t)}async registerFileURL(e,r,t,s){r===void 0&&(r=e);let n=new h("REGISTER_FILE_URL",[e,r,t,s]);await this.postTask(n)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,r){let t=new h("REGISTER_FILE_BUFFER",[e,r]);await this.postTask(t,[r.buffer])}async registerFileHandle(e,r,t,s){let n=new h("REGISTER_FILE_HANDLE",[e,r,t,s]);await this.postTask(n,[])}async collectFileStatistics(e,r){let t=new h("COLLECT_FILE_STATISTICS",[e,r]);await this.postTask(t,[])}async exportFileStatistics(e){let r=new h("EXPORT_FILE_STATISTICS",e);return await this.postTask(r,[])}async copyFileToBuffer(e){let r=new h("COPY_FILE_TO_BUFFER",e);return await this.postTask(r)}async copyFileToPath(e,r){let t=new h("COPY_FILE_TO_PATH",[e,r]);await this.postTask(t)}async insertArrowFromIPCStream(e,r,t){if(r.length==0)return;let s=new h("INSERT_ARROW_FROM_IPC_STREAM",[e,r,t]);await this.postTask(s,[r.buffer])}async insertCSVFromPath(e,r,t){if(t.columns!==void 0){let n=[];for(let a in t.columns){let o=t.columns[a];n.push(Jr(a,o))}t.columnsFlat=n,delete t.columns}let s=new h("IMPORT_CSV_FROM_PATH",[e,r,t]);await this.postTask(s)}async insertJSONFromPath(e,r,t){if(t.columns!==void 0){let n=[];for(let a in t.columns){let o=t.columns[a];n.push(Jr(a,o))}t.columnsFlat=n,delete t.columns}let s=new h("IMPORT_JSON_FROM_PATH",[e,r,t]);await this.postTask(s)}};var Zr={name:"@duckdb/duckdb-wasm",version:"1.29.1-dev3.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"apache-arrow":"^17.0.0"},devDependencies:{"@types/emscripten":"^1.39.10","@types/jasmine":"^5.1.4","@typescript-eslint/eslint-plugin":"^6.21.0","@typescript-eslint/parser":"^6.21.0",esbuild:"^0.20.2",eslint:"^8.57.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.34.0","fast-glob":"^3.3.2",jasmine:"^5.1.0","jasmine-core":"^5.1.2","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.11.0",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-coverage":"^2.2.1","karma-firefox-launcher":"^2.1.3","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","karma-sourcemap-loader":"^0.4.0","karma-spec-reporter":"^0.0.36","make-dir":"^4.0.0",nyc:"^15.1.0",prettier:"^3.2.5",puppeteer:"^22.8.0",rimraf:"^5.0.5",s3rver:"^3.7.1",typedoc:"^0.25.13",typescript:"^5.3.3","wasm-feature-detect":"^1.6.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/tests-*","!dist/duckdb-browser-mvp.worker.js.map","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-node-blocking.d.ts",import:"./dist/duckdb-node-blocking.mjs",require:"./dist/duckdb-node-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}},bI=Zr.name,wI=Zr.version,Xr=Zr.version.split("."),DI=Xr[0],NI=Xr[1],kI=Xr[2];var OI=Td(fd());function Nd(){let e=new TextDecoder;return r=>(typeof SharedArrayBuffer<"u"&&r.buffer instanceof SharedArrayBuffer&&(r=new Uint8Array(r)),e.decode(r))}var AI=Nd(),ur=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(ur||{});var mn=null;function hn(){return mn}function dr(e){mn=e}import*as U from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";import*as p from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";var kd=Object.create,Tn=Object.defineProperty,Od=Object.getOwnPropertyDescriptor,Ad=Object.getOwnPropertyNames,Pd=Object.getPrototypeOf,Cd=Object.prototype.hasOwnProperty,Ld=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Fd=(e,r,t,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Ad(r))!Cd.call(e,n)&&n!==t&&Tn(e,n,{get:()=>r[n],enumerable:!(s=Od(r,n))||s.enumerable});return e},Md=(e,r,t)=>(t=e!=null?kd(Pd(e)):{},Fd(r||!e||!e.__esModule?Tn(t,"default",{value:e,enumerable:!0}):t,e)),Ud=Ld((e,r)=>{r.exports=Worker}),Bd=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(Bd||{}),qd=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(qd||{}),xd=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(xd||{}),jd=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(jd||{}),Gd=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(Gd||{}),Qd=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(Qd||{});var fn=class{constructor(e=2){this.level=e}log(e){e.level>=this.level&&console.log(e)}};var Wd=(e=>(e[e.SUCCESS=0]="SUCCESS",e))(Wd||{}),Yd=class{constructor(e,r){this._bindings=e,this._conn=r}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let r=await this._bindings.runQuery(this._conn,e),t=U.RecordBatchReader.from(r);return console.assert(t.isSync(),"Reader is not sync"),console.assert(t.isFile(),"Reader is not file"),new U.Table(t)}async send(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let r=await this._bindings.startPendingQuery(this._conn,e);for(;r==null;)r=await this._bindings.pollPendingQuery(this._conn);let t=new Rn(this._bindings,this._conn,r),s=await U.RecordBatchReader.from(t);return console.assert(s.isAsync()),console.assert(s.isStream()),s}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let r=await this._bindings.createPrepared(this._conn,e);return new Hd(this._bindings,this._conn,r)}async insertArrowTable(e,r){let t=U.tableToIPC(e,"stream");await this.insertArrowFromIPCStream(t,r)}async insertArrowFromIPCStream(e,r){await this._bindings.insertArrowFromIPCStream(this._conn,e,r)}async insertCSVFromPath(e,r){await this._bindings.insertCSVFromPath(this._conn,e,r)}async insertJSONFromPath(e,r){await this._bindings.insertJSONFromPath(this._conn,e,r)}},Rn=class{constructor(e,r,t){this.db=e,this.conn=r,this.header=t,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e;return this._inFlight!=null?(e=await this._inFlight,this._inFlight=null):e=await this.db.fetchQueryResults(this.conn),this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},Hd=class{constructor(e,r,t){this.bindings=e,this.connectionId=r,this.statementId=t}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let r=await this.bindings.runPrepared(this.connectionId,this.statementId,e),t=U.RecordBatchReader.from(r);return console.assert(t.isSync()),console.assert(t.isFile()),new U.Table(t)}async send(...e){let r=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),t=new Rn(this.bindings,this.connectionId,r),s=await U.RecordBatchReader.from(t);return console.assert(s.isAsync()),console.assert(s.isStream()),s}},$d=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))($d||{}),Vd=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(Vd||{}),T=class{constructor(e,r){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=r,this.promise=new Promise((t,s)=>{this.promiseResolver=t,this.promiseRejecter=s})}};function lr(e){switch(e.typeId){case p.Type.Binary:return{sqlType:"binary"};case p.Type.Bool:return{sqlType:"bool"};case p.Type.Date:return{sqlType:"date"};case p.Type.DateDay:return{sqlType:"date32[d]"};case p.Type.DateMillisecond:return{sqlType:"date64[ms]"};case p.Type.Decimal:{let r=e;return{sqlType:"decimal",precision:r.precision,scale:r.scale}}case p.Type.Float:return{sqlType:"float"};case p.Type.Float16:return{sqlType:"float16"};case p.Type.Float32:return{sqlType:"float32"};case p.Type.Float64:return{sqlType:"float64"};case p.Type.Int:return{sqlType:"int32"};case p.Type.Int16:return{sqlType:"int16"};case p.Type.Int32:return{sqlType:"int32"};case p.Type.Int64:return{sqlType:"int64"};case p.Type.Uint16:return{sqlType:"uint16"};case p.Type.Uint32:return{sqlType:"uint32"};case p.Type.Uint64:return{sqlType:"uint64"};case p.Type.Uint8:return{sqlType:"uint8"};case p.Type.IntervalDayTime:return{sqlType:"interval[dt]"};case p.Type.IntervalYearMonth:return{sqlType:"interval[m]"};case p.Type.List:return{sqlType:"list",valueType:lr(e.valueType)};case p.Type.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case p.Type.Null:return{sqlType:"null"};case p.Type.Utf8:return{sqlType:"utf8"};case p.Type.Struct:return{sqlType:"struct",fields:e.children.map(r=>at(r.name,r.type))};case p.Type.Map:{let r=e;return{sqlType:"map",keyType:lr(r.keyType),valueType:lr(r.valueType)}}case p.Type.Time:return{sqlType:"time[s]"};case p.Type.TimeMicrosecond:return{sqlType:"time[us]"};case p.Type.TimeMillisecond:return{sqlType:"time[ms]"};case p.Type.TimeNanosecond:return{sqlType:"time[ns]"};case p.Type.TimeSecond:return{sqlType:"time[s]"};case p.Type.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case p.Type.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case p.Type.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case p.Type.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case p.Type.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function at(e,r){let t=lr(r);return t.name=e,t}var Kd=new TextEncoder,gn=class{constructor(e,r=null){this._onInstantiationProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),r!=null&&this.attach(r)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((r,t)=>{this._workerShutdownResolver=r})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,r=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let t=this._nextMessageId++;return this._pendingRequests.set(t,e),this._worker.postMessage({messageId:t,type:e.type,data:e.data},r),await e.promise}onMessage(e){var r;let t=e.data;switch(t.type){case"LOG":{this._logger.log(t.data);return}case"INSTANTIATE_PROGRESS":{for(let n of this._onInstantiationProgress)n(t.data);return}}let s=this._pendingRequests.get(t.requestId);if(!s){console.warn("unassociated response: [".concat(t.requestId,", ").concat(t.type.toString(),"]"));return}if(this._pendingRequests.delete(t.requestId),t.type=="ERROR"){let n=new Error(t.data.message);n.name=t.data.name,(r=Object.getOwnPropertyDescriptor(n,"stack"))!=null&&r.writable&&(n.stack=t.data.stack),s.promiseRejecter(n);return}switch(s.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(t.type=="OK"){s.promiseResolver(t.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],t.type=="OK"){s.promiseResolver(t.data);return}break;case"GLOB_FILE_INFOS":if(t.type=="FILE_INFOS"){s.promiseResolver(t.data);return}break;case"GET_VERSION":if(t.type=="VERSION_STRING"){s.promiseResolver(t.data);return}break;case"GET_FEATURE_FLAGS":if(t.type=="FEATURE_FLAGS"){s.promiseResolver(t.data);return}break;case"GET_TABLE_NAMES":if(t.type=="TABLE_NAMES"){s.promiseResolver(t.data);return}break;case"TOKENIZE":if(t.type=="SCRIPT_TOKENS"){s.promiseResolver(t.data);return}break;case"COPY_FILE_TO_BUFFER":if(t.type=="FILE_BUFFER"){s.promiseResolver(t.data);return}break;case"EXPORT_FILE_STATISTICS":if(t.type=="FILE_STATISTICS"){s.promiseResolver(t.data);return}break;case"CONNECT":if(t.type=="CONNECTION_INFO"){s.promiseResolver(t.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(t.type=="QUERY_RESULT"){s.promiseResolver(t.data);return}break;case"SEND_PREPARED":if(t.type=="QUERY_RESULT_HEADER"){s.promiseResolver(t.data);return}break;case"START_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){s.promiseResolver(t.data);return}break;case"POLL_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){s.promiseResolver(t.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],t.type=="SUCCESS"){s.promiseResolver(t.data);return}break;case"FETCH_QUERY_RESULTS":if(t.type=="QUERY_RESULT_CHUNK"){s.promiseResolver(t.data);return}break;case"CREATE_PREPARED":if(t.type=="PREPARED_STATEMENT_ID"){s.promiseResolver(t.data);return}break}s.promiseRejecter(new Error("unexpected response type: ".concat(t.type.toString())))}onError(e){console.error(e),console.error("error in duckdb worker: ".concat(e.message)),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"));return}this._pendingRequests.clear()}async reset(){let e=new T("RESET",null);return await this.postTask(e)}async ping(){let e=new T("PING",null);await this.postTask(e)}async dropFile(e){let r=new T("DROP_FILE",e);return await this.postTask(r)}async dropFiles(){let e=new T("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new T("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,r=null,t=s=>{}){this._onInstantiationProgress.push(t);let s=new T("INSTANTIATE",[e,r]);return await this.postTask(s)}async getVersion(){let e=new T("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new T("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let r=new T("OPEN",e);await this.postTask(r)}async tokenize(e){let r=new T("TOKENIZE",e);return await this.postTask(r)}async connectInternal(){let e=new T("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new Yd(this,e)}async disconnect(e){let r=new T("DISCONNECT",e);await this.postTask(r)}async runQuery(e,r){let t=new T("RUN_QUERY",[e,r]);return await this.postTask(t)}async startPendingQuery(e,r){let t=new T("START_PENDING_QUERY",[e,r]);return await this.postTask(t)}async pollPendingQuery(e){let r=new T("POLL_PENDING_QUERY",e);return await this.postTask(r)}async cancelPendingQuery(e){let r=new T("CANCEL_PENDING_QUERY",e);return await this.postTask(r)}async fetchQueryResults(e){let r=new T("FETCH_QUERY_RESULTS",e);return await this.postTask(r)}async getTableNames(e,r){let t=new T("GET_TABLE_NAMES",[e,r]);return await this.postTask(t)}async createPrepared(e,r){let t=new T("CREATE_PREPARED",[e,r]);return await this.postTask(t)}async closePrepared(e,r){let t=new T("CLOSE_PREPARED",[e,r]);await this.postTask(t)}async runPrepared(e,r,t){let s=new T("RUN_PREPARED",[e,r,t]);return await this.postTask(s)}async sendPrepared(e,r,t){let s=new T("SEND_PREPARED",[e,r,t]);return await this.postTask(s)}async globFiles(e){let r=new T("GLOB_FILE_INFOS",e);return await this.postTask(r)}async registerFileText(e,r){let t=Kd.encode(r);await this.registerFileBuffer(e,t)}async registerFileURL(e,r,t,s){r===void 0&&(r=e);let n=new T("REGISTER_FILE_URL",[e,r,t,s]);await this.postTask(n)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,r){let t=new T("REGISTER_FILE_BUFFER",[e,r]);await this.postTask(t,[r.buffer])}async registerFileHandle(e,r,t,s){let n=new T("REGISTER_FILE_HANDLE",[e,r,t,s]);await this.postTask(n,[])}async collectFileStatistics(e,r){let t=new T("COLLECT_FILE_STATISTICS",[e,r]);await this.postTask(t,[])}async exportFileStatistics(e){let r=new T("EXPORT_FILE_STATISTICS",e);return await this.postTask(r,[])}async copyFileToBuffer(e){let r=new T("COPY_FILE_TO_BUFFER",e);return await this.postTask(r)}async copyFileToPath(e,r){let t=new T("COPY_FILE_TO_PATH",[e,r]);await this.postTask(t)}async insertArrowFromIPCStream(e,r,t){if(r.length==0)return;let s=new T("INSERT_ARROW_FROM_IPC_STREAM",[e,r,t]);await this.postTask(s,[r.buffer])}async insertCSVFromPath(e,r,t){if(t.columns!==void 0){let n=[];for(let a in t.columns){let o=t.columns[a];n.push(at(a,o))}t.columnsFlat=n,delete t.columns}let s=new T("IMPORT_CSV_FROM_PATH",[e,r,t]);await this.postTask(s)}async insertJSONFromPath(e,r,t){if(t.columns!==void 0){let n=[];for(let a in t.columns){let o=t.columns[a];n.push(at(a,o))}t.columnsFlat=n,delete t.columns}let s=new T("IMPORT_JSON_FROM_PATH",[e,r,t]);await this.postTask(s)}};var zd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),Jd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),Zd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),Xd=()=>(async e=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),it={name:"@duckdb/duckdb-wasm",version:"1.29.1-dev3.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"apache-arrow":"^17.0.0"},devDependencies:{"@types/emscripten":"^1.39.10","@types/jasmine":"^5.1.4","@typescript-eslint/eslint-plugin":"^6.21.0","@typescript-eslint/parser":"^6.21.0",esbuild:"^0.20.2",eslint:"^8.57.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.34.0","fast-glob":"^3.3.2",jasmine:"^5.1.0","jasmine-core":"^5.1.2","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.11.0",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-coverage":"^2.2.1","karma-firefox-launcher":"^2.1.3","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","karma-sourcemap-loader":"^0.4.0","karma-spec-reporter":"^0.0.36","make-dir":"^4.0.0",nyc:"^15.1.0",prettier:"^3.2.5",puppeteer:"^22.8.0",rimraf:"^5.0.5",s3rver:"^3.7.1",typedoc:"^0.25.13",typescript:"^5.3.3","wasm-feature-detect":"^1.6.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",report:"node ./coverage.mjs","test:node":"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/tests-*","!dist/duckdb-browser-mvp.worker.js.map","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-node-blocking.d.ts",import:"./dist/duckdb-node-blocking.mjs",require:"./dist/duckdb-node-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}},qI=it.name,xI=it.version,ot=it.version.split("."),jI=ot[0],GI=ot[1],QI=ot[2],el=()=>typeof navigator>"u";var et=null,rt=null,tt=null,st=null,nt=null;async function rl(){return et==null&&(et=typeof BigInt64Array<"u"),rt==null&&(rt=await Jd()),tt==null&&(tt=await Xd()),st==null&&(st=await Zd()),nt==null&&(nt=await zd()),{bigInt64Array:et,crossOriginIsolated:el()||globalThis.crossOriginIsolated||!1,wasmExceptions:rt,wasmSIMD:st,wasmThreads:tt,wasmBulkMemory:nt}}async function In(e){let r=await rl();if(r.wasmExceptions){if(r.wasmSIMD&&r.wasmThreads&&r.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}var WI=Md(Ud());function tl(){let e=new TextDecoder;return r=>(typeof SharedArrayBuffer<"u"&&r.buffer instanceof SharedArrayBuffer&&(r=new Uint8Array(r)),e.decode(r))}var YI=tl(),sl=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(sl||{});function _n(e){return URL.createObjectURL(new Blob([`importScripts("${e}");`],{type:"text/javascript"}))}function ct(e){let r=/^https?:\/\//.test(e);return r?{crossOrigin:r,url:_n(e)}:{crossOrigin:r,url:e}}function yn(e){let r=e?.inputPrefix,t=e?.includeCOI,s=r?r.endsWith("/")?r:r+"/":"/",n={eh:{mainModule:s+"duckdb-eh.wasm",mainWorker:s+"duckdb-browser-eh.worker.js"},mvp:{mainModule:s+"duckdb-mvp.wasm",mainWorker:s+"duckdb-browser-mvp.worker.js"}};return t&&(n.coi={mainModule:s+"duckdb-coi.wasm",mainWorker:s+"duckdb-browser-coi.worker.js",pthreadWorker:s+"duckdb-browser-coi.pthread.worker.js"}),n}async function Sn(e){let r=await In(e?.bundles??yn({includeCOI:e?.includeCOI}));if(!r.mainWorker)throw new Error("Main worker not found");let t=ct(r.mainWorker),s=r.pthreadWorker?ct(r.pthreadWorker):null,n=e?.logger??new fn(e?.logLevel),a=new Worker(t.url),o=e?.createAsyncDuckDB?e.createAsyncDuckDB(n,a):new gn(n,a);return await o.instantiate(r.mainModule,s?.url,e?.progress),t.crossOrigin&&URL.revokeObjectURL(t.url),s?.crossOrigin&&URL.revokeObjectURL(s.url),o}import{Table as c_}from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";function vn(e){return!e||e.startsWith("DEV-")?"":e}function O(e,r){return r.length===0?e:e.endsWith("/")?`${e}${r}`:`${e}/${r}`}function bn(e){return e!=null&&typeof e=="object"&&"mvp"in e}function wn(e,r,t){let s={mvp:{mainModule:O(e,r.mvp.mainModule),mainWorker:O(e,r.mvp.mainWorker)}};return r.eh&&(s.eh={mainModule:O(e,r.eh.mainModule),mainWorker:O(e,r.eh.mainWorker)}),r.coi&&t&&(s.coi={mainModule:O(e,r.coi.mainModule),mainWorker:O(e,r.coi.mainWorker),pthreadWorker:O(e,r.coi.pthreadWorker)}),s}async function Dn(e,r,t){let s=vn(r),n=O(e,s),a=O(n,"duckdb-assets.json"),u=await(await fetch(a)).json();if(!bn(u))throw new Error(`Expected duckdb-assets.json to contain DuckDBBundles, but got: ${u}`);return wn(n,u,t)}async function Nn(e){let r=e.duckDBAssetsURLPrefix||"https://app.motherduck.com/",t=new URL(r==="/"?window.origin:r),s=e.version||await ar(t),n=s?.startsWith("DEV-"),a=await Dn(t.href,s,e.useDuckDBWasmCOI),o=await Sn({bundles:a,logLevel:e.enableDebugLogging?cr.INFO:cr.WARNING});await o.open({allowUnsignedExtensions:n,customUserAgent:e.customUserAgent});let u=await o.connect();return await u.query("LOAD icu;"),await u.close(),await un({instance:o,token:e.mdToken,extensionRepositoryUrlPrefix:t,extensionVersion:n?"":s,apiUrl:e.mdServerURL?new URL(e.mdServerURL):void 0,logLevel:e.enableDebugLogging?Ge.DEBUG:Ge.ERROR}),dr(o),o}async function ce(e){let r=hn();return r||(r=Nn(e),dr(r),r)}var av=ju(Su(),1);var b;(function(e){e[e.Pending=0]="Pending",e[e.Running=1]="Running",e[e.Resolved=2]="Resolved",e[e.Rejected=3]="Rejected"})(b||(b={}));var Gr=class{nextTaskId=1;queuedTaskIds=[];queuedTasksById={};processingQueue=!1;logger;constructor(r){this.logger=r}incompleteTaskCount(){let r=0;for(let t of this.queuedTaskIds){let s=this.queuedTasksById[t];s&&(s.state===b.Pending||s.state===b.Running)&&r++}return r}enqueueTask(r){let t=this.createTaskId();return this.logDebug(`enqueueTask: creating task id = ${t}`),this.addQueuedTask({id:t,task:r,state:b.Pending,deferred:Promise.withResolvers(),cancelled:!1}),this.scheduleProcessQueueIfNeeded(),t}async cancelTask(r,t){this.logDebug(`cancelTask(${r}): called`);let s=this.queuedTasksById[r];if(!s)throw new Error(`Task with id ${r} not found`);switch(s.state){case b.Pending:return s.cancelled?this.logDebug(`cancelTask(${r}): cancelling pending task (already cancelled)`):(this.logDebug(`cancelTask(${r}): cancelling pending task`),s.cancelled=!0,s.deferred.reject(new Error(t??"pending task cancelled")),this.scheduleProcessQueueIfNeeded()),!0;case b.Running:return this.logDebug(`cancelTask(${r}): cancelling running task`),s.cancelled=!0,s.task.cancel();case b.Resolved:return this.logDebug(`cancelTask(${r}): can't cancel resolved task`),!1;case b.Rejected:return this.logDebug(`cancelTask(${r}): can't cancel rejected task`),!1;default:throw s.state,new Error("unreachable")}}taskResult(r){this.logDebug(`taskResults(${r}): called`);let t=this.queuedTasksById[r];if(!t)throw new Error(`Task with id ${r} not found`);return t.deferred.promise}logDebug(r){this.logger&&this.logger.debug(r)}logWarn(r){this.logger&&this.logger.warn(r)}createTaskId(){return`t${this.nextTaskId++}`}addQueuedTask(r){this.queuedTaskIds.push(r.id),this.queuedTasksById[r.id]=r}scheduleProcessQueueIfNeeded(){this.processingQueue?this.logDebug("scheduleProcessQueueIfNeeded: processQueue already scheduled"):(this.logDebug("scheduleProcessQueueIfNeeded: scheduling processQueue"),this.processingQueue=!0,setTimeout(()=>{this.processQueue(),this.processingQueue=!1},0))}processQueue(){this.logDebug("processQueue: processing started");let r;do r=this.processFirstQueuedTask();while(r);this.logDebug("processQueue: processing completed")}processFirstQueuedTask(){if(this.queuedTaskIds.length===0)return this.logDebug("processFirstQueuedTask: queue empty"),!1;let r=this.queuedTaskIds[0];this.logDebug(`processFirstQueuedTask: processing task ${r}`);let t=this.queuedTasksById[r];if(!t)return this.logWarn(`processFirstQueuedTask: task ${r} not found in map`),this.queuedTaskIds.shift(),!0;switch(t.state){case b.Pending:return t.cancelled?(this.logDebug(`processFirstQueuedTask: removing cancelled pending task ${r} from queue`),this.queuedTaskIds.shift(),delete this.queuedTasksById[t.id],!0):(this.logDebug(`processFirstQueuedTask: running pending task ${r}`),t.state=b.Running,t.task.run().then(s=>{this.logDebug(`processFirstQueuedTask: task ${r} resolved`),t.state=b.Resolved,t.deferred.resolve(s)}).catch(s=>{this.logDebug(`processFirstQueuedTask: task ${r} rejected`),t.state=b.Rejected,t.deferred.reject(s)}).finally(()=>{this.scheduleProcessQueueIfNeeded()}),!1);case b.Running:return this.logDebug(`processFirstQueuedTask: task ${r} at front of queue is already running`),!1;case b.Resolved:case b.Rejected:return this.logDebug(`processFirstQueuedTask: task ${r} at front of queue is completed, removing from queue`),this.queuedTaskIds.shift(),delete this.queuedTasksById[t.id],!0;default:throw t.state,new Error("unreachable")}}};import{DateUnit as vu,IntervalUnit as Ls,Precision as Fs,TimeUnit as J,Type as y,UnionMode as bu}from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";function Z(e,r=new Map){switch(e.typeId){case y.Null:return c.SQLNULL;case y.Int:{let{isSigned:t,bitWidth:s}=e;if(t)switch(s){case 8:return c.TINYINT;case 16:return c.SMALLINT;case 32:return c.INTEGER;case 64:return c.BIGINT;default:throw Error(`unexpected integer bit width: ${s}`)}else switch(s){case 8:return c.UTINYINT;case 16:return c.USMALLINT;case 32:return c.UINTEGER;case 64:return c.UBIGINT;default:throw Error(`unexpected integer bit width: ${s}`)}}case y.Float:{let{precision:t}=e;switch(t){case Fs.HALF:throw Error("DuckDB does not support half-precision floats");case Fs.SINGLE:return c.REAL;case Fs.DOUBLE:return c.DOUBLE;default:throw Error(`unexpected precision: ${t}`)}}case y.Binary:return c.BLOB;case y.Utf8:return c.VARCHAR;case y.Bool:return c.BOOLEAN;case y.Decimal:{let{precision:t,scale:s}=e;return(t==null||t===18)&&(s==null||s===3)?c.DECIMAL():c.DECIMAL(t,s)}case y.Date:{let{unit:t}=e;switch(t){case vu.DAY:return c.DATE;case vu.MILLISECOND:throw Error("DuckDB does not support millisecond-unit dates");default:throw Error(`unexpected date unit: ${t}`)}}case y.Time:{let{unit:t}=e;switch(t){case J.SECOND:throw Error("DuckDB does not support second-unit times");case J.MILLISECOND:throw Error("DuckDB does not support millisecond-unit times");case J.MICROSECOND:return c.TIME;case J.NANOSECOND:throw Error("DuckDB does not support nanosecond-unit times");default:throw Error(`unexpected time unit: ${t}`)}}case y.Timestamp:{let{unit:t,timezone:s}=e;switch(t){case J.SECOND:if(s)throw Error("DuckDB does not support second-unit timestamps with timezone");return c.TIMESTAMP_S;case J.MILLISECOND:if(s)throw Error("DuckDB does not support millisecond-unit timestamps with timezone");return c.TIMESTAMP_MS;case J.MICROSECOND:return s?c.TIMESTAMP_TZ:c.TIMESTAMP;case J.NANOSECOND:if(s)throw Error("DuckDB does not support nanosecond-unit timestamps with timezone");return c.TIMESTAMP_NS;default:throw Error(`unexpected time unit: ${t}`)}}case y.Interval:{let{unit:t}=e;switch(t){case Ls.YEAR_MONTH:throw Error("DuckDB does not support year-month intervals");case Ls.DAY_TIME:throw Error("DuckDB does not support day-time intervals");case Ls.MONTH_DAY_NANO:return c.INTERVAL;default:throw Error(`unexpected interval unit: ${t}`)}}case y.List:{let{valueType:t,children:s}=e;return c.LIST(Z(t,s.length>0?s[0].metadata:new Map))}case y.Struct:{let{children:t}=e,s=t.map(n=>({key:n.name,valueType:Z(n.type,n.metadata)}));return c.STRUCT(s)}case y.Union:{let{mode:t}=e;switch(t){case bu.Dense:throw Error("DuckDB does not support dense unions");case bu.Sparse:{let s=e.children.map(n=>({tag:n.name,valueType:Z(n.type,n.metadata)}));return c.UNION(s)}default:throw Error(`unexpected union mode: ${t}`)}}case y.FixedSizeBinary:switch(r.get("ARROW:extension:name")){case"arrow.uuid":return c.UUID;case"duckdb.uhugeint":return c.UHUGEINT;case"duckdb.hugeint":return c.HUGEINT;case"duckdb.time_tz":return c.TIME_TZ;default:return c.UHUGEINT}case y.FixedSizeList:{let{valueType:t,listSize:s,children:n}=e;return c.ARRAY(Z(t,n.length>0?n[0].metadata:new Map),s)}case y.Map:{let{keyType:t,valueType:s}=e;return c.MAP(Z(t),Z(s))}case y.Dictionary:return c.ENUM;default:throw Error(`unexpected type id: ${e.typeId}`)}}import{DateUnit as wu,IntervalUnit as Ms,Precision as Us,TimeUnit as X,Type as S,UnionMode as Du}from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";var qs=8,Bs=qs*8,vf=new TextDecoder;function bf(e,r,t){return e.getValid(r)?t(e,r):null}function R(e){return(r,t)=>bf(r,t,e)}function wf(e,r,t,s){return Array.from({length:t-r}).map((n,a)=>s(e,r+a))}function ku(e){return new BigInt64Array(e.values.buffer,e.values.byteOffset,e.values.length/2)}function Df(e,r){return ku(e)[r]}function Qr(e,r){return e.values[r]}function Nf(e,r){let t=ku(e),s=t[r*2];return(t[r*2+1]<<BigInt(64))+(s&BigInt.asUintN(64,BigInt(-1)))}function Ou(e,r){let{values:t,valueOffsets:s}=e,n=s[r],a=s[r+1];return t.subarray(n,a)}function xs(e,r){let{byteWidth:t}=e.type,{values:s}=e,n=t*r,a=t*(r+1);return s.subarray(n,a)}function kf(e,r){return null}function Of(e,r){return e.values[r]}var j=R(Of);function Af(e,r){return new we(Ou(e,r))}var Pf=R(Af);function Cf(e,r){return new qe(xs(e,r))}var Lf=R(Cf);function Ff(e,r){let t=xs(e,r),s=new DataView(t.buffer,t.byteOffset,t.byteLength),n=s.getBigInt64(qs,!0),a=s.getBigUint64(0,!0);return(n<<BigInt(Bs))+(a&BigInt.asUintN(Bs,BigInt(-1)))}var Mf=R(Ff);function Uf(e,r){let t=xs(e,r),s=new DataView(t.buffer,t.byteOffset,t.byteLength),n=s.getBigUint64(qs,!0),a=s.getBigUint64(0,!0);return(n<<BigInt(Bs))+a}var Nu=R(Uf);function Bf(e,r){return vf.decode(Ou(e,r))}var qf=R(Bf);function xf(e,r){let t=e.offset+r;return(e.values[t>>3]&1<<t%8)!==0}var jf=R(xf);function Gf(e,r){return new ke(Nf(e,r),e.type.scale)}var Qf=R(Gf);function Wf(e,r){return new Ne(e.values[r])}var Yf=R(Wf);function Hf(e,r){return new Le(e.values[r])}var $f=R(Hf);function Vf(e,r){throw Error("TIME_TZ with arrow_lossless_conversion is not supported.")}var Kf=R(Vf);function zf(e,r){return new Be(Qr(e,r))}var Jf=R(zf);function Zf(e,r){return new Me(Qr(e,r))}var Xf=R(Zf);function eR(e,r){return new Fe(Qr(e,r),e.type.timezone)}var rR=R(eR);function tR(e,r){return new Ue(Qr(e,r))}var sR=R(tR);function nR(e,r){return new Oe(e.values[r*4],e.values[r*4+1],Df(e,r*2+1)/BigInt(1e3))}var aR=R(nR);function iR(e,r){let{children:t,valueOffsets:s,type:n}=e,a=s[r],o=s[r+1];return new Ae(Pu(t[0],a,o,n.children[0].metadata))}var oR=R(iR);function cR(e,r){let t=[],{children:s,type:n}=e,a=n.children;for(let o=0;o<s.length;o++){let u=s[o],d=a[o].name,E=_e(u,r,a[o].metadata);t.push({key:d,value:E})}return new Ce(t)}var uR=R(cR);function dR(e,r){let{children:t,typeIds:s}=e,n=s[r],a=e.type.typeIdToChildIndex[n],o=t[a];return _e(o,r,e.type.children[a].metadata)}function lR(e,r){let{children:t,type:s}=e,{listSize:n}=s,a=r*n,o=a+n;return new be(Pu(t[0],a,o,s.children[0].metadata))}var pR=R(lR);function ER(e,r){let t=[],{children:s,valueOffsets:n}=e,a=n[r],o=n[r+1],[u,d]=s[0].children;for(let E=a;E<o;E++)t.push({key:_e(u,E),value:_e(d,E)});return new Pe(t)}var mR=R(ER);function hR(e,r){return e.dictionary&&e.dictionary.length>0?e.dictionary.get(e.values[r]):e.values[r]}var TR=R(hR);function Au(e,r){switch(e.typeId){case S.Null:return kf;case S.Int:{let{isSigned:t,bitWidth:s}=e;if(t)switch(s){case 8:return j;case 16:return j;case 32:return j;case 64:return j;default:throw Error(`unexpected integer bit width: ${s}`)}else switch(s){case 8:return j;case 16:return j;case 32:return j;case 64:return j;default:throw Error(`unexpected integer bit width: ${s}`)}}case S.Float:{let{precision:t}=e;switch(t){case Us.HALF:throw Error("DuckDB does not support half-precision floats");case Us.SINGLE:return j;case Us.DOUBLE:return j;default:throw Error(`unexpected precision: ${t}`)}}case S.Binary:return Pf;case S.Utf8:return qf;case S.Bool:return jf;case S.Decimal:return Qf;case S.Date:{let{unit:t}=e;switch(t){case wu.DAY:return Yf;case wu.MILLISECOND:throw Error("DuckDB does not support millisecond-unit dates");default:throw Error(`unexpected date unit: ${t}`)}}case S.Time:{let{unit:t}=e;switch(t){case X.SECOND:throw Error("DuckDB does not support second-unit times");case X.MILLISECOND:throw Error("DuckDB does not support millisecond-unit times");case X.MICROSECOND:return $f;case X.NANOSECOND:throw Error("DuckDB does not support nanosecond-unit times");default:throw Error(`unexpected time unit: ${t}`)}}case S.Timestamp:{let{unit:t,timezone:s}=e;switch(t){case X.SECOND:if(s)throw Error("DuckDB does not support second-unit timestamps with time zone");return Jf;case X.MILLISECOND:if(s)throw Error("DuckDB does not support millisecond-unit timestamps with time zone");return Xf;case X.MICROSECOND:return rR;case X.NANOSECOND:if(s)throw Error("DuckDB does not support nanosecond-unit timestamps with time zone");return sR;default:throw Error(`unexpected time unit: ${t}`)}}case S.Interval:{let{unit:t}=e;switch(t){case Ms.YEAR_MONTH:throw Error("DuckDB does not support year-month intervals");case Ms.DAY_TIME:throw Error("DuckDB does not support day-time intervals");case Ms.MONTH_DAY_NANO:return aR;default:throw Error(`unexpected interval unit: ${t}`)}}case S.List:return oR;case S.Struct:return uR;case S.Union:{let{mode:t}=e;switch(t){case Du.Dense:throw Error("DuckDB does not support dense unions");case Du.Sparse:return dR;default:throw Error(`unexpected union mode: ${t}`)}}case S.FixedSizeBinary:switch(r.get("ARROW:extension:name")){case"arrow.uuid":return Lf;case"duckdb.uhugeint":return Nu;case"duckdb.hugeint":return Mf;case"duckdb.time_tz":return Kf;default:return Nu}case S.FixedSizeList:return pR;case S.Map:return mR;case S.Dictionary:return TR;default:throw Error(`unexpected type id: ${e.typeId}`)}}function _e(e,r,t=new Map){return Au(e.type,t)(e,r)}function Pu(e,r,t,s=new Map){let n=Au(e.type,s);return wf(e,r,t,n)}var Wr=class extends W{recordBatch;constructor(r){super(),this.recordBatch=r}get columnCount(){return this.recordBatch.schema.fields.length}get rowCount(){return this.recordBatch.data.length}columnName(r){return this.recordBatch.schema.fields[r].name}columnType(r){let t=this.recordBatch.schema.fields[r];return Z(t.type,t.metadata)}value(r,t){let s=this.recordBatch.data.children[r],n=this.recordBatch.schema.fields[r].metadata;return _e(s,t,n)}};var js=Object.freeze({done:!0,value:void 0}),ye=class{recordBatchIterator;constructor(r){this.recordBatchIterator=r}async next(){let{done:r,value:t}=await this.recordBatchIterator.next();return t?{done:!!r,value:new Wr(t)}:js}async return(r){return this.recordBatchIterator.return&&await this.recordBatchIterator.return(),r?{done:!0,value:r}:js}async throw(r){return this.recordBatchIterator.throw&&await this.recordBatchIterator.throw(r),js}[Symbol.asyncIterator](){return this}};var Se=class{connection=null;deferredConnection;query;args;constructor(r,t,s){this.deferredConnection=r,this.query=t,this.args=s}async run(){let r=performance.now(),t=await this.sendQuery(),s=new ye(t),n=new ee(s);await n.readAll();let a=performance.now();for(let o=0;o<n.columnCount;o++)n.columnType(o);return{type:"materialized",startTimeMs:r,endTimeMs:a,data:n}}async cancel(){return(this.connection||await this.getConnection()).cancelSent()}async getConnection(){return this.connection=await this.deferredConnection,this.connection}async sendQuery(){let r=this.connection||await this.getConnection();return this.args&&this.args?.length>0?(await r.prepare(this.query)).send(...this.args):r.send(this.query)}};var sr=class{connection=null;deferredConnection;query;args;constructor(r,t,s){this.deferredConnection=r,this.query=t,this.args=s}async run(){let r=await this.sendQuery(),t=new ye(r),s=new ee(t);return{type:"streaming",arrowStream:r,dataStream:t,dataReader:s}}async cancel(){return(this.connection||await this.getConnection()).cancelSent()}async getConnection(){return this.connection=await this.deferredConnection,this.connection}async sendQuery(){let r=this.connection||await this.getConnection();return this.args&&this.args?.length>0?(await r.prepare(this.query)).send(this.args):r.send(this.query)}};async function Cu(e){return await(await ce(e)).connect()}var Lu=class e{params;deferredDdbConnection;sequencer;constructor(r,t){this.params=r,this.deferredDdbConnection=t,this.sequencer=new Gr(r.logger)}static create(r){let t=Cu(r);return new e(r,t)}async isInitialized(){return await this.deferredDdbConnection,!0}async tokenize(r){return(await this.deferredDdbConnection).bindings.tokenize(r)}incompleteQueryCount(){return this.sequencer.incompleteTaskCount()}enqueueQuery(r,t){return this.sequencer.enqueueTask(new Se(this.deferredDdbConnection,r,t))}async safePrepareQuery(r){try{return{status:"success",preparedStatement:await this.prepareQuery(r)}}catch(t){return{status:"error",err:t}}}async safeEvaluateQuery(r){try{return{status:"success",result:await this.evaluateQuery(r)}}catch(t){return{status:"error",err:t}}}async safeEvaluatePreparedStatement(r,...t){try{return{status:"success",result:await this.evaluatePreparedStatement(r,t)}}catch(s){return{status:"error",err:s}}}async safeEvaluateStreamingQuery(r){try{return{status:"success",result:await this.evaluateStreamingQuery(r)}}catch(t){return{status:"error",err:t}}}async safeEvaluateStreamingPreparedStatement(r,t){try{return{status:"success",result:await this.evaluateStreamingPreparedStatement(r,t)}}catch(s){return{status:"error",err:s}}}async safeEvaluateQueuedQuery(r){try{return{status:"success",result:await this.evaluateQueuedQuery(r)}}catch(t){return{status:"error",err:t}}}async prepareQuery(r){return(await this.deferredDdbConnection).prepare(r)}async evaluateQuery(r){return this.evaluateExclusive(new Se(this.deferredDdbConnection,r))}async evaluatePreparedStatement(r,t){return this.evaluateExclusive(new Se(this.deferredDdbConnection,r,t))}async evaluateStreamingQuery(r){return this.evaluateExclusive(new sr(this.deferredDdbConnection,r,void 0))}async evaluateStreamingPreparedStatement(r,t){return this.evaluateExclusive(new sr(this.deferredDdbConnection,r,t))}async evaluateExclusive(r){let t=this.sequencer.enqueueTask(r);return this.sequencer.taskResult(t)}async evaluateQueuedQuery(r){return this.sequencer.taskResult(r)}async cancelQuery(r,t){return this.sequencer.cancelTask(r,t)}async close(){return(await this.deferredDdbConnection).close()}};import{AsyncRecordBatchStreamReader as Jv,DataType as Zv}from"https://cdn.jsdelivr.net/npm/apache-arrow@17.0.0/+esm";async function sb(e){return(await ce(e)).globFiles("*")}async function ob(e,r){let t=await ce(e);for(let s=0;s<r.length;++s){let n=r.item(s);await t.dropFile(n.name),await t.registerFileHandle(n.name,n,ur.BROWSER_FILEREADER,!1)}}export{Dd as AsyncDuckDB,En as AsyncPreparedStatement,Jv as AsyncRecordBatchStreamReader,Zv as DataType,be as DuckDBArray,we as DuckDBBlob,W as DuckDBData,ur as DuckDBDataProtocol,ee as DuckDBDataReader,Ne as DuckDBDate,ke as DuckDBDecimal,Oe as DuckDBInterval,Ae as DuckDBList,Pe as DuckDBMap,Ce as DuckDBStruct,Le as DuckDBTime,Fe as DuckDBTimestampMicroseconds,Me as DuckDBTimestampMilliseconds,Ue as DuckDBTimestampNanoseconds,Be as DuckDBTimestampSeconds,c as DuckDBTypes,qe as DuckDBUUID,Lu as MDConnection,Hs as MemoryDuckDBData,je as MotherDuckCatalogChangeEvent,ir as MotherDuckEventBase,oe as MotherDuckEventType,m as SpecialDuckDBValue,ln as TokenType,re as duckDBTypeToString,ce as getAsyncDuckDb,ve as parseLogicalTypeString,sb as readLocalFS,ob as registerFiles};
